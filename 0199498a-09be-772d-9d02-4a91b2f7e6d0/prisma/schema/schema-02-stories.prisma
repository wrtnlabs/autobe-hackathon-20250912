/// Master table for AI-generated fairy tales. Each record represents a
/// complete story created by an authenticated user, with metadata such as
/// title, main plot, language, and creation details. Each story can have
/// multiple pages ({@link storyfield_ai_story_pages}), images ({@link
/// storyfield_ai_story_images}), and TTS results ({@link
/// storyfield_ai_tts_results}). Ownership is tracked by foreign key to
/// authenticated users. Supports soft deletion and audit trails for content
/// moderation, copyright disputes, and compliance.
///
/// @namespace Stories
/// @author AutoBE - https://github.com/wrtnlabs/autobe
model storyfield_ai_stories {
  //----
  // COLUMNS
  //----
  /// Primary Key.
  id String @id
  
  /// Owner's {@link storyfield_ai_authenticatedusers.id}. The user who created
  /// this story.
  storyfield_ai_authenticateduser_id String
  
  /// Title of the story as provided or generated by the user.
  title String
  
  /// The main plot or summary provided as the core input for this story.
  main_plot String?
  
  /// Primary language or dialect option chosen for this story instance (e.g.,
  /// Korean, Gyeongsang dialect).
  language String
  
  /// Record creation timestamp. Required for audit trail and ordering.
  created_at DateTime
  
  /// Record last update time. Required for modification tracking.
  updated_at DateTime
  
  /// Soft deletion time for GDPR and moderation compliance.
  deleted_at DateTime?
  
  //----
  // RELATIONS
  //----
  authenticatedUser storyfield_ai_authenticatedusers @relation(fields: [storyfield_ai_authenticateduser_id], references: [id], onDelete: Cascade)
  
  storyfield_ai_story_pages storyfield_ai_story_pages[]
  storyfield_ai_story_images storyfield_ai_story_images[]
  storyfield_ai_tts_results storyfield_ai_tts_results[]
  storyfield_ai_integration_logs storyfield_ai_integration_logs[]
  storyfield_ai_s3_upload_histories storyfield_ai_s3_upload_histories[]
  storyfield_ai_external_api_failures storyfield_ai_external_api_failures[]
  
  @@unique([storyfield_ai_authenticateduser_id, title], map: "storyfield_ai_stories_storyfield_ai_authenticateduser__b6d8f312")
  @@index([created_at])
  @@index([storyfield_ai_authenticateduser_id])
  @@index([deleted_at])
}

/// Stores the textual content and ordering for each page within a story.
/// Pages are independently addressable to allow specific moderation or user
/// revision (e.g., editing a single page). Connected to its parent story
/// ({@link storyfield_ai_stories.id}) and may have multiple supporting
/// images ({@link storyfield_ai_story_images}). Page number enforces logical
/// order. Soft deletion and temporal fields for compliance, moderation, and
/// granular auditing.
///
/// @namespace Stories
/// @author AutoBE - https://github.com/wrtnlabs/autobe
model storyfield_ai_story_pages {
  //----
  // COLUMNS
  //----
  /// Primary Key.
  id String @id
  
  /// Reference to parent story's {@link storyfield_ai_stories.id}.
  storyfield_ai_story_id String
  
  /// The sequential page number within the story. Used for natural ordering.
  page_number Int
  
  /// Textual content for the page. AI-generated or user-edited.
  text String
  
  /// Timestamp when the page was created.
  created_at DateTime
  
  /// Last update time for the page.
  updated_at DateTime
  
  /// Soft deletion for this page, supporting recoverability and compliance.
  deleted_at DateTime?
  
  //----
  // RELATIONS
  //----
  story storyfield_ai_stories @relation(fields: [storyfield_ai_story_id], references: [id], onDelete: Cascade)
  
  storyfield_ai_story_images storyfield_ai_story_images[]
  storyfield_ai_tts_results storyfield_ai_tts_results[]
  
  @@unique([storyfield_ai_story_id, page_number], map: "storyfield_ai_story_pages_storyfield_ai_story_id_page__76bf7564")
  @@index([storyfield_ai_story_id])
  @@index([deleted_at])
}

/// Stores generated or user-provided images associated with stories or
/// specific pages. Each image can be tied to a parent story, a specific
/// page, or both. Used to display illustrations within stories or as
/// thumbnails. Images references their storage (typically S3) by URI. Only
/// supporting entity; must always belong to a parent story and optionally a
/// page. Deleted via soft delete if parent is deleted.
///
/// @namespace Stories
/// @author AutoBE - https://github.com/wrtnlabs/autobe
model storyfield_ai_story_images {
  //----
  // COLUMNS
  //----
  /// Primary Key.
  id String @id
  
  /// Parent story's {@link storyfield_ai_stories.id}.
  storyfield_ai_story_id String
  
  /// Specific page's {@link storyfield_ai_story_pages.id} if image is tied to
  /// a page. Nullable for story-overall images.
  storyfield_ai_story_page_id String?
  
  /// URI (usually S3 URL) of the image storage location.
  image_uri String
  
  /// Optional alt text or description for accessibility or search.
  description String?
  
  /// When image was added or generated.
  created_at DateTime
  
  /// Last modification time of image record.
  updated_at DateTime
  
  /// Soft deletion timestamp. Image becomes inaccessible if set.
  deleted_at DateTime?
  
  //----
  // RELATIONS
  //----
  story storyfield_ai_stories @relation(fields: [storyfield_ai_story_id], references: [id], onDelete: Cascade)
  storyPage storyfield_ai_story_pages? @relation(fields: [storyfield_ai_story_page_id], references: [id], onDelete: Cascade)
  
  @@index([storyfield_ai_story_id])
  @@index([storyfield_ai_story_page_id])
  @@index([deleted_at])
}

/// Stores results of text-to-speech generation for both entire stories and
/// specific pages. Each record contains the URI of the audio file, the text
/// source, and links to the owning story and, if relevant, the specific
/// page. Used to enable playback for users, accessibility features, and
/// dialect variation support. Not directly created by users, but is returned
/// or accessed as business artifacts of story creation. Soft delete
/// supported for data removal and compliance.
///
/// @namespace Stories
/// @author AutoBE - https://github.com/wrtnlabs/autobe
model storyfield_ai_tts_results {
  //----
  // COLUMNS
  //----
  /// Primary Key.
  id String @id
  
  /// Story's {@link storyfield_ai_stories.id} for which this TTS was produced.
  storyfield_ai_story_id String
  
  /// Story page's {@link storyfield_ai_story_pages.id} if TTS is for a
  /// specific page. Nullable for whole-story TTS.
  storyfield_ai_story_page_id String?
  
  /// URI of the generated TTS audio file (e.g. S3 pre-signed URL).
  tts_audio_uri String
  
  /// The text from which TTS was generated.
  source_text String
  
  /// Dialect or language option used in TTS result.
  dialect String
  
  /// When TTS was generated or uploaded.
  created_at DateTime
  
  /// When record was last modified.
  updated_at DateTime
  
  /// Soft deletion for regulatory and content-management purposes.
  deleted_at DateTime?
  
  //----
  // RELATIONS
  //----
  story storyfield_ai_stories @relation(fields: [storyfield_ai_story_id], references: [id], onDelete: Cascade)
  storyPage storyfield_ai_story_pages? @relation(fields: [storyfield_ai_story_page_id], references: [id], onDelete: Cascade)
  
  @@index([storyfield_ai_story_id])
  @@index([storyfield_ai_story_page_id])
  @@index([dialect])
  @@index([deleted_at])
}