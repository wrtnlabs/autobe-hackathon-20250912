import { tags } from "typia";

/**
 * User authentication credential record for the healthcare platform. Stores
 * provider info, credential hashes (if any), last authenticated timestamp, and
 * audit timestamps. Used for login, SSO, and federated authentication records,
 * referenced by actor/user entities (systemadmin, orgadmin, doctor, etc.).
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type IHealthcarePlatformUserAuthentication = {
  /**
   * Unique identifier for the user authentication record. References the
   * authentication credential row in the system.
   */
  id: string & tags.Format<"uuid">;

  /**
   * UUID of the user this authentication record belongs to. Cross-table
   * reference (systemadmin/orgadmin/etc).
   */
  user_id: string & tags.Format<"uuid">;

  /**
   * Type of user/actor this authentication record is associated with (e.g.,
   * 'systemadmin', 'organizationadmin', 'medicaldoctor').
   */
  user_type: string;

  /**
   * Authentication provider (e.g., 'local', 'saml', 'oauth2', 'ad').
   * Indicates login mechanism this record supports.
   */
  provider: string;

  /**
   * Provider-specific user or session key (such as SSO subject, user_id, or
   * external service subject identifier).
   */
  provider_key: string;

  /**
   * (Optional) Bcrypt hash for local authentication. Not set for SSO
   * providers.
   */
  password_hash?: string | null | undefined;

  /**
   * Timestamp of last successful authentication with this record. May be null
   * if never authenticated.
   */
  last_authenticated_at?:
    | (string & tags.Format<"date-time">)
    | null
    | undefined;

  /**
   * ISO8601 timestamp when the authentication record was created (audit trail
   * & compliance).
   */
  created_at: string & tags.Format<"date-time">;

  /** ISO8601 timestamp when authentication record was last updated. */
  updated_at: string & tags.Format<"date-time">;

  /** Timestamp of soft deletion (nullable). Null means record is active. */
  deleted_at?: (string & tags.Format<"date-time">) | null | undefined;
};
export namespace IHealthcarePlatformUserAuthentication {
  /**
   * Payload for advanced search/filtering/pagination of user authentication
   * records. Used by administrators/staff to retrieve user/provider
   * authentication credential records by provider, user type, creation time,
   * sorting, or page controls.
   */
  export type IRequest = {
    /**
     * String identifier indicating user entity type (e.g., 'systemAdmin',
     * 'organizationAdmin', 'medicalDoctor', etc.) for filtered
     * authentication record retrieval.
     */
    user_type?: string | undefined;

    /**
     * Authentication provider type. Values may include 'local', 'saml',
     * 'oauth2', 'ad', etc.
     */
    provider?: string | undefined;

    /**
     * Unique key value for filtering by authentication provider
     * user/session key (opaque string or subject identifier for
     * SSO/federated logins).
     */
    provider_key?: string | undefined;

    /** Return authentication records created after this ISO 8601 timestamp. */
    created_after?: (string & tags.Format<"date-time">) | undefined;

    /** Return authentication records created before this ISO 8601 timestamp. */
    created_before?: (string & tags.Format<"date-time">) | undefined;

    /** Result page number, default is 1. Used for pagination. */
    page?: (number & tags.Type<"int32">) | undefined;

    /** Number of results per page for pagination. Default is 50. */
    page_size?: (number & tags.Type<"int32">) | undefined;

    /**
     * Sort field for authentication record search results. Accepts column
     * name and direction (e.g., 'created_at:asc', 'provider:desc').
     */
    sort?: string | undefined;
  };

  /**
   * Request body for creating a new user authentication credential record.
   * Required for onboarding new users, adding authentication methods, or
   * federated provider integration.
   */
  export type ICreate = {
    /**
     * UUID of the user this authentication record will be associated with
     * (must match actor table/role).
     */
    user_id: string & tags.Format<"uuid">;

    /**
     * Type of actor/user for authentication (e.g., 'systemadmin',
     * 'departmentHead', etc.)
     */
    user_type: string;

    /**
     * Provider type for this authentication record (e.g., 'local', 'saml',
     * 'oauth2', 'ad').
     */
    provider: string;

    /**
     * Provider-specific user/session key (e.g., SSO subject, username, or
     * external ID).
     */
    provider_key: string;

    /**
     * (Optional) Credential hash for local (bcrypt or compatible). Omit or
     * set null for SSO providers.
     */
    password_hash?: string | null | undefined;
  };

  /**
   * Request body for updating an existing user authentication credential
   * record. Used for credential rotation, provider or key update, toggling or
   * tracking authentication state, and soft deletion.
   */
  export type IUpdate = {
    /** (Optional) Updated provider for this authentication record. */
    provider?: string | undefined;

    /** (Optional) Updated provider-specific key for authentication. */
    provider_key?: string | undefined;

    /** (Optional) New hash value to rotate or reset the local credential. */
    password_hash?: string | null | undefined;

    /** (Optional) Set or clear the last authenticated time. */
    last_authenticated_at?:
      | (string & tags.Format<"date-time">)
      | null
      | undefined;

    /** ISO8601 timestamp of update event (to be set to now on update). */
    updated_at?: (string & tags.Format<"date-time">) | undefined;

    /** (Optional) Timestamp for soft-delete of record (null for active). */
    deleted_at?: (string & tags.Format<"date-time">) | null | undefined;
  };

  /**
   * Summary type for user authentication records (for
   * listing/search/pagination).
   *
   * Represents a minimal authentication credential record for admin queries,
   * audit, or session display.
   *
   * Includes fields from healthcare_platform_user_authentications: id,
   * user_type, user_id, provider, provider_key, timestamps, and soft-delete
   * fields. Does not expose any credential data (password_hash, tokens,
   * etc).
   *
   * Follows UUID and ISO8601 standards for identifier and timestamp fields.
   */
  export type ISummary = {
    /**
     * Unique identifier for this authentication record (UUID).
     *
     * Corresponds to the 'id' column in
     * healthcare_platform_user_authentications.
     */
    id: string & tags.Format<"uuid">;

    /**
     * User type for this authentication (systemadmin, orgadmin, nurse,
     * etc).
     *
     * Matches the 'user_type' field.
     */
    user_type: string;

    /**
     * User UUID for the actor/principal this authentication record is
     * associated with.
     *
     * Corresponds to 'user_id'.
     */
    user_id: string & tags.Format<"uuid">;

    /**
     * Authentication provider type (local, saml, oauth2, ad, etc).
     *
     * Corresponds to 'provider'.
     */
    provider: string;

    /**
     * Provider-specific key or handle (e.g., SSO subject, username, etc).
     *
     * Matches 'provider_key'.
     */
    provider_key: string;

    /**
     * Timestamp when this record was created. Corresponds to 'created_at',
     * ISO8601 string.
     */
    created_at: string & tags.Format<"date-time">;

    /**
     * Timestamp this record was last updated. Corresponds to 'updated_at',
     * ISO8601 string.
     */
    updated_at: string & tags.Format<"date-time">;

    /**
     * Timestamp for when user last authenticated (ISO8601), if available.
     * Corresponds to 'last_authenticated_at'.
     */
    last_authenticated_at?:
      | (string & tags.Format<"date-time">)
      | null
      | undefined;

    /**
     * Soft-delete timestamp, if authentication record is deleted.
     * Corresponds to 'deleted_at', nullable.
     */
    deleted_at?: (string & tags.Format<"date-time">) | null | undefined;
  };
}
