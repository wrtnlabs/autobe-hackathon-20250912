{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"chatbot_room_tuples","description":"Room tuples define mappings between normal chat rooms and their linked admin rooms. This table stores session isolation mappings and controls admin authorization by maintaining unique identifiers, room IDs, display names, and enablement statuses. It ensures proper role determination and supports operational enablement and soft deletion. Key fields include normal_room_id and admin_room_id for chat routing, display name for identification, and unique_id as a business identity key. Auditing fields track creation, update, and deletion times.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"normal_room_id","type":"string","nullable":false,"description":"Identifier for the normal chat room used for member participation."},{"name":"admin_room_id","type":"string","nullable":false,"description":"Identifier for the corresponding admin room controlling administrative commands."},{"name":"display_name","type":"string","nullable":false,"description":"User-friendly display name for this room tuple, used for identification."},{"name":"unique_id","type":"string","nullable":false,"description":"Unique business identifier for this room tuple, ensuring uniqueness across system."},{"name":"enabled","type":"boolean","nullable":false,"description":"Flag indicating if the room tuple is currently active and operational in the system."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when this room tuple record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when this room tuple record was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp indicating when this room tuple record was soft deleted, if applicable."}],"uniqueIndexes":[{"fieldNames":["unique_id"],"unique":true}],"plainIndexes":[{"fieldNames":["normal_room_id","enabled"]},{"fieldNames":["admin_room_id","enabled"]}],"ginIndexes":[]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"chatbot_members","description":"Member user of the chatbot system who interacts in normal rooms. Holds internal sender id, nickname, and timestamps. Independent entity for user identity management in the system. Connected to points, titles, and sessions managed elsewhere.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"internal_sender_id","type":"string","nullable":false,"description":"Internal unique identifier for the member, mapped from external sender ID, used for internal system logic and privacy."},{"name":"nickname","type":"string","nullable":false,"description":"Nickname displayed for the member in chat rooms, mutable by user or system."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the member record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the member record was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp when the member record was soft-deleted (nullable)."}],"uniqueIndexes":[{"fieldNames":["internal_sender_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"nickname"}]},{"name":"chatbot_admins","description":"Admin user of the chatbot system operating via admin rooms. Holds internal sender id and nickname. Responsible for elevated permissions and management tasks within the system.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"internal_sender_id","type":"string","nullable":false,"description":"Internal unique identifier for the admin, mapped from external sender ID, used for internal system logic and privacy."},{"name":"nickname","type":"string","nullable":false,"description":"Nickname displayed for the admin in admin rooms, mutable by system."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the admin record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the admin record was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp when the admin record was soft-deleted (nullable)."}],"uniqueIndexes":[{"fieldNames":["internal_sender_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[{"fieldName":"nickname"}]}]},{"filename":"schema-03-points.prisma","namespace":"Points","models":[{"name":"chatbot_points","description":"Stores the current point balance for each member. This main business entity tracks points accumulated by users based on message activity. Points are updated in real-time and are essential for minigames and user rankings. References the member owning the points.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"chatbot_member_id","type":"uuid","description":"Referenced member's {@link chatbot_members.id} owning these points.","relation":{"name":"member","targetModel":"chatbot_members"},"unique":true,"nullable":false}],"plainFields":[{"name":"points","type":"int","nullable":false,"description":"Current total points accumulated by the user."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."}],"uniqueIndexes":[{"fieldNames":["chatbot_member_id"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"chatbot_point_cooldowns","description":"Records the last point award time per member to enforce the 1-second cooldown rule. Tracks when a user last earned points to prevent rapid point farming. This supporting entity complements the points system for fair point distribution.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"chatbot_member_id","type":"uuid","description":"Referenced member's {@link chatbot_members.id} for cooldown tracking.","relation":{"name":"member","targetModel":"chatbot_members"},"unique":true,"nullable":false}],"plainFields":[{"name":"last_point_time","type":"datetime","nullable":true,"description":"Timestamp of the last point awarded to the member."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."}],"uniqueIndexes":[{"fieldNames":["chatbot_member_id"],"unique":true}],"plainIndexes":[{"fieldNames":["last_point_time"]}],"ginIndexes":[]}]},{"filename":"schema-04-titles.prisma","namespace":"Titles","models":[{"name":"chatbot_titles","description":"User title definitions providing fee discount rates and descriptive names. This table stores the distinct titles that can be assigned by administrators to users to grant special benefits such as reduced transaction fees in minigames. The entity is a primary business object with full CRUD capabilities. It is normalized and indexed to allow efficient querying by title name and fee discount.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"name","type":"string","nullable":false,"description":"The name of the title visible to users and used for display purposes."},{"name":"fee_discount_rate","type":"int","nullable":false,"description":"The fee discount rate percentage this title grants on minigame transactions, e.g., 0 to 100%."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the title record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the title record was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp when the title record was soft-deleted, if applicable."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["fee_discount_rate"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"chatbot_user_titles","description":"Associations of users to assigned titles with related fee discount applicability. Each record links one user with one title along with assignment timestamps and soft deletion support. This table supports enforceable business rules such as one active title per user and historical tracking for assignment auditing. References chatbot_members and chatbot_titles table primary keys.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"chatbot_member_id","type":"uuid","nullable":false,"unique":true,"description":"Belonged user's {@link chatbot_members.id}. Ensures one-to-one relation representing the user's assigned title.","relation":{"name":"member","targetModel":"chatbot_members"}},{"name":"chatbot_title_id","type":"uuid","nullable":false,"unique":false,"description":"Referenced title's {@link chatbot_titles.id}. The title assigned to the user.","relation":{"name":"title","targetModel":"chatbot_titles"}}],"plainFields":[{"name":"assigned_at","type":"datetime","nullable":false,"description":"Timestamp when the title was assigned to the user."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the user-title association record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the user-title association record was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp when the user-title association record was soft-deleted, if applicable."}],"uniqueIndexes":[{"fieldNames":["chatbot_member_id"],"unique":true}],"plainIndexes":[{"fieldNames":["assigned_at"]}],"ginIndexes":[]}]},{"filename":"schema-05-stocks.prisma","namespace":"Stocks","models":[{"name":"chatbot_stock_items","description":"Table storing virtual stock items available for trading. Includes unique stock codes, names, initial prices, and soft delete handling. This primary table serves as the master list of stock definitions for the virtual stock trading domain.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","nullable":false,"description":"Unique business code for the stock item."},{"name":"name","type":"string","nullable":false,"description":"Display name of the stock item."},{"name":"initial_price","type":"int","nullable":false,"description":"Initial price of the stock item in points."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the stock item was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of the last update to the stock item record."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp; null if active."}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true},{"fieldNames":["name"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"chatbot_stock_holdings","description":"Tracks each user's holdings of stock items. Links users to stock items with the quantity held. Ensures uniqueness for the user-item pair and supports soft deletes. Essential for portfolio management in the stock trading system.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"user_id","type":"uuid","nullable":false,"unique":false,"description":"Owner user of the stock holdings. {@link chatbot_members.id}","relation":{"name":"user","targetModel":"chatbot_members"}},{"name":"stock_item_id","type":"uuid","nullable":false,"unique":false,"description":"Stock item referenced. {@link chatbot_stock_items.id}","relation":{"name":"stockItem","targetModel":"chatbot_stock_items"}}],"plainFields":[{"name":"quantity","type":"int","nullable":false,"description":"Number of stock units held by user."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of when this holding record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last update to the holding record."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp, null if holding is active."}],"uniqueIndexes":[{"fieldNames":["user_id","stock_item_id"],"unique":true}],"plainIndexes":[{"fieldNames":["user_id"]},{"fieldNames":["stock_item_id"]}],"ginIndexes":[]},{"name":"chatbot_stock_transactions","description":"Records all stock transactions made by users. Captures transaction type, quantity, unit price, fees, total price, and timestamp. Links to user and stock item ensuring referential integrity. This primary table supports full audit trails of trading activity.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"user_id","type":"uuid","nullable":false,"unique":false,"description":"User conducting the transaction. {@link chatbot_members.id}","relation":{"name":"user","targetModel":"chatbot_members"}},{"name":"stock_item_id","type":"uuid","nullable":false,"unique":false,"description":"Stock item involved in the transaction. {@link chatbot_stock_items.id}","relation":{"name":"stockItem","targetModel":"chatbot_stock_items"}}],"plainFields":[{"name":"transaction_type","type":"string","nullable":false,"description":"Transaction type: 'buy' or 'sell'."},{"name":"quantity","type":"int","nullable":false,"description":"Quantity of stock units in the transaction."},{"name":"price_per_unit","type":"int","nullable":false,"description":"Price per unit at transaction time in points."},{"name":"transaction_fee","type":"int","nullable":false,"description":"Fee charged for this transaction in points."},{"name":"total_price","type":"int","nullable":false,"description":"Total price after fees in points."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of the transaction."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["user_id","created_at"]}],"ginIndexes":[]},{"name":"chatbot_stock_price_snapshots","description":"Stores historical price snapshots of stock items for audit and analytics. Each record uniquely identifies a snapshot by stock item and timestamp. Snapshot stance indicates append-only, immutable history.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"stock_item_id","type":"uuid","nullable":false,"unique":false,"description":"Stock item linked to this price snapshot. {@link chatbot_stock_items.id}","relation":{"name":"stockItem","targetModel":"chatbot_stock_items"}}],"plainFields":[{"name":"price","type":"int","nullable":false,"description":"Stock price at snapshot time in points."},{"name":"snapshot_time","type":"datetime","nullable":false,"description":"Timestamp when this snapshot was recorded."}],"uniqueIndexes":[{"fieldNames":["stock_item_id","snapshot_time"],"unique":true}],"plainIndexes":[{"fieldNames":["snapshot_time"]}],"ginIndexes":[]},{"name":"chatbot_stock_price_updates","description":"Records each stock price update event with date, optional admin who triggered the event, and notes. Tracks daily updates for the virtual stock system. Supports auditing and operational tracking.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"updated_by_admin_id","type":"uuid","nullable":true,"unique":false,"description":"Admin who triggered the update, nullable if system triggered. {@link chatbot_admins.id}","relation":{"name":"updatedByAdmin","targetModel":"chatbot_admins"}}],"plainFields":[{"name":"update_date","type":"datetime","nullable":false,"description":"Date and time this price update occurred."},{"name":"notes","type":"string","nullable":true,"description":"Optional notes about this update."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."}],"uniqueIndexes":[{"fieldNames":["update_date"],"unique":true}],"plainIndexes":[],"ginIndexes":[]}]},{"filename":"schema-06-slotmachine.prisma","namespace":"SlotMachine","models":[{"name":"chatbot_slotmachine_plays","description":"Slot machine gameplay records capturing individual spin details including user reference, bet amount, slot results, payout, and timestamps. Enables audit and analysis of minigame activity separated from user and point domains to improve modularity and maintainability.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"chatbot_member_id","type":"uuid","description":"Referenced member who played the slot machine. {@link chatbot_members.id}.","relation":{"name":"member","targetModel":"chatbot_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"bet_points","type":"int","nullable":false,"description":"Number of points the user bet on this spin."},{"name":"slot1","type":"int","nullable":false,"description":"Result of first slot digit (0-9)."},{"name":"slot2","type":"int","nullable":false,"description":"Result of second slot digit (0-9)."},{"name":"slot3","type":"int","nullable":false,"description":"Result of third slot digit (0-9)."},{"name":"payout_points","type":"int","nullable":false,"description":"Points won from this spin, zero if none."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the play was recorded."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["chatbot_member_id","created_at"]}],"ginIndexes":[]}]},{"filename":"schema-07-commands.prisma","namespace":"Commands","models":[{"name":"chatbot_command_logs","description":"Chatbot command logs record all executed commands by users and admins with timestamps, user references, command content, and parameters. This table serves as an append-only historical record for auditing command usage and admin actions. It references the chatbot_members table's id to associate each log entry with the executing user. The model supports comprehensive auditing and tracking of all commands processed in chatbot rooms.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"chatbot_member_id","type":"uuid","description":"Referencing the chatbot member who executed the command. {@link chatbot_members.id}.","relation":{"name":"member","targetModel":"chatbot_members"},"unique":false,"nullable":false}],"plainFields":[{"name":"command","type":"string","description":"The exact command string issued by the user or admin, including parameters.","nullable":false},{"name":"command_parameters","type":"string","description":"Parameters passed with the command, stored as a JSON string or plain text representation.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the command was executed, stored in UTC.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]}]},{"filename":"schema-08-audit.prisma","namespace":"Audit","models":[{"name":"chatbot_audit_logs","description":"Audit log entries recording detailed operational events across the chatbot system, including minigame results, command executions, stock transactions, and stock price changes. It preserves immutable historical data for compliance, analysis, and debugging purposes. References users ({@link chatbot_members.id}), rooms ({@link chatbot_room_tuples.id}) and event types to support filtering and auditing.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"chatbot_member_id","type":"uuid","description":"Referenced chatbot member {@link chatbot_members.id} associated with the audit event. Nullable if event is system generated.","relation":{"name":"member","targetModel":"chatbot_members"},"unique":false,"nullable":true},{"name":"chatbot_room_tuple_id","type":"uuid","description":"Referenced chatbot room tuple {@link chatbot_room_tuples.id} related to the event. Nullable when not applicable.","relation":{"name":"roomTuple","targetModel":"chatbot_room_tuples"},"unique":false,"nullable":true}],"plainFields":[{"name":"event_type","type":"string","nullable":false,"description":"Type of audit event such as 'command_execution', 'minigame_play', 'stock_transaction', or 'stock_price_change'."},{"name":"event_payload","type":"string","nullable":false,"description":"Detailed JSON-encoded string containing the event specifics, parameters, and results for audit purposes."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the audit event was recorded in the system."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["event_type","created_at"]},{"fieldNames":["chatbot_member_id","created_at"]},{"fieldNames":["chatbot_room_tuple_id","created_at"]}],"ginIndexes":[{"fieldName":"event_payload"}]}]}]}