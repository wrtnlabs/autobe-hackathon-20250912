# EasySign 전자계약 서비스 백엔드 요구사항

## 1. 개요
EasySign은 계약 전 과정을 디지털화하여 시간과 장소에 구애받지 않고 쉽고 빠르며 안전하게 계약을 체결할 수 있도록 지원하는 대한민국 대표 전자계약 서비스이다. 이 서비스는 계약 과정의 비효율성, 비용 증가, 서류 위변조 위험을 해소하여 업무 효율성을 극대화한다.

## 2. 사용자 역할 및 인증 요구사항

### 2.1 사용자 역할 정의 및 권한 분리
- 개인 사용자(freelancerUser)는 별도의 승인 절차 없이 본인이 생성한 계약 문서에 대해 전권한을 가진다.
- 법인 사용자(corporateUser)는 계약 문서 생성 후 팀장(teamLeader)의 검토 및 승인 절차를 거쳐야 하며, 승인된 문서만 서명 요청이 가능하다.
- 팀장(teamLeader)은 법인 계약서의 검토 및 승인, 팀원 권한 관리를 담당한다.
- 관리자(admin)는 시스템 전반에 대한 모든 권한을 가지며, 사용자 및 시스템 설정 관리를 수행한다.

### 2.2 인증 흐름 및 JWT 토큰 관리
- 사용자는 이메일과 비밀번호를 통해 회원가입 및 로그인을 할 수 있다.
- 로그인 성공 시 서버는 암호화된 JWT 액세스 토큰과 리프레시 토큰을 발급한다.
- 토큰은 액세스 토큰(15~30분)과 리프레시 토큰(7~30일)으로 구성되며, 토큰 검증 실패 시 적절한 에러를 반환한다.
- OAuth 2.0 방식으로 구글 및 카카오 소셜 로그인을 지원한다.
- 2단계 인증(2FA)은 로그인과 중요 정보 변경 시 적용된다.

## 3. 주요 기능 및 비즈니스 프로세스

### 3.1 문서 업로드 및 변환
- 지원 파일 포맷은 PDF, DOCX, HWP, XLSX, PNG, JPG이며, 서버는 모두 PDF로 변환 저장한다.
- 사용자는 드래그 앤 드롭 방식으로 문서를 업로드할 수 있다.
- 업로드된 문서는 원본 해시값을 생성하여 위변조를 방지한다.

### 3.2 서명 필드 배치 및 서명 요청 발송
- 사용자는 문서 내 서명, 텍스트, 체크박스, 날짜 필드를 드래그하여 배치한다.
- 각 필드는 특정 서명자에게 할당 가능하며, 필수 입력 여부 설정이 가능하다.
- 서명 요청은 이메일, 카카오톡 및 옵션으로 SMS를 통해 발송된다.
- 발송자는 서명 순서를 순차 또는 동시 서명 방식으로 지정할 수 있다.

### 3.3 서명 진행 및 완료 문서 처리
- 서명자는 별도 회원가입 없이 링크를 클릭해 서명할 수 있으며, PC, 모바일, 태블릿에서 모두 작동하는 반응형 UI를 지원한다.
- 서명 방식은 그리기, 텍스트, 도장 이미지 업로드를 지원한다.
- 모든 서명이 완료되면, 서버는 원본 PDF에 서명 이미지를 삽입하여 읽기 전용 최종본을 생성한다.
- 최종 서명 완료 문서와 감사추적인증서는 즉시 생성 및 사용자에게 제공된다.

### 3.4 템플릿 관리 및 대량 발송
- 사용자들은 서명 필드 배치 상태를 템플릿으로 저장하고, 재사용할 수 있다.
- 대량 발송 기능은 이메일, 카카오톡, SMS 채널을 통해 다수에게 서명 요청을 일괄 발송할 수 있다.

### 3.5 API 연동 및 외부 서비스 통합
- RESTful API를 통해 문서 업로드, 서명 요청, 상태 조회, 문서 다운로드 기능을 제공한다.
- Zapier, Google Drive, Dropbox, Slack 등 주요 SaaS와 연동을 지원한다.

## 4. 법적 요구사항 및 감사 추적

### 4.1 서명 이미지 PDF 삽입
- 모든 서명자가 완료되어 문서 상태가 COMPLETED가 되면, 서버는 원본 PDF에 각 서명자의 서명 이미지를 지정 좌표에 삽입한다.
- 최종 문서는 읽기 전용(Flattening) 처리를 하여 추가 편집을 방지한다.

### 4.2 감사추적인증서 생성 및 배포
- 계약 완료 즉시 감사추적인증서가 실시간 생성되며, 문서 정보, 참여자 정보, 모든 이벤트 로그를 포함한다.
- 사용자에게 다운로드 가능한 상태로 제공되어야 한다.

### 4.3 블록체인 해시 기록 전략
- 최종 서명 완료본 PDF와 감사추적인증서 PDF의 해시값을 결합하여 최종 결과 해시값을 생성한다.
- 이 해시값을 단일 블록체인 트랜잭션으로 기록하여 문서 및 인증서의 무결성을 수학적으로 증명한다.

## 5. 보안 및 데이터 보호

### 5.1 데이터 암호화 및 키 관리
- 모든 저장 데이터는 AES-256 수준으로 암호화한다.
- 암호화 키는 AWS KMS 또는 Google Cloud KMS를 사용해 안전하게 관리하며, 연 1회 이상 키를 순환한다.

### 5.2 접근 권한 통제 및 RBAC
- 역할 기반 접근 제어를 도입하여 사용자 역할에 따른 권한을 엄격히 제한한다.
- 애플리케이션 레벨에서 소유권 검증 로직을 적용하여 사용자가 자신의 문서에만 접근 가능하도록 한다.

### 5.3 인증 및 다단계 인증
- JWT 기반 인증과 2단계 인증(2FA)을 로그인 및 중요 정보 변경 시 적용한다.
- 관리자 전용 관리 페이지 접근을 별도로 분리한다.

## 6. 오류 처리 및 예외 상황

### 6.1 업로드 및 포맷 오류 처리
- 지원하지 않는 파일 포맷이 업로드될 경우, 명확한 오류 메시지를 사용자에게 전달한다.

### 6.2 서명 요청 및 진행 오류
- 서명 요청 발송 실패 시 재시도하며, 실패 기록을 로그에 남긴다.

### 6.3 권한 및 인증 오류
- 인증 실패 시 HTTP 401 에러를 반환하고, 권한 없는 접근 시 HTTP 403 에러를 반환한다.

## 7. 성능, 가용성 및 확장성

### 7.1 성능 기준
- 문서 업로드 및 페이지 로딩 시간은 3초 이내여야 한다.

### 7.2 가용성 목표
- 서비스는 99.9% 이상의 가동 시간을 유지해야 한다.

### 7.3 확장성 설계
- 클라우드 기반 아키텍처를 사용하여 증가하는 사용자 수와 트래픽에 유연하게 대응해야 한다.

## 8. 모니터링 및 성공 지표

### 8.1 성공 지표
- 활성 사용자 수(MAU), 계약 발송 및 체결 건수, 업무 효율성(평균 소요 시간), 전환율, 고객 만족도 등 주요 지표를 포함한다.

### 8.2 모니터링 및 장애 대응
- 시스템 장애 및 오류 발생시 알림 및 조기 경고 체계를 구축한다.

### 8.3 지속적 개선
- 사용자 행동 데이터를 분석하여 서비스 개선에 반영한다.

## 9. 부록

### 9.1 용어 정의
- JWT: JSON Web Token
- AES-256: 고급 암호화 표준 256비트
- RBAC: 역할 기반 접근 제어
- 2FA: 2단계 인증

## Mermaid Diagram

```mermaid
graph LR
  A["문서 업로드"] --> B{"서명 필드 배치 완료 확인"}
  B --|"예"| C["서명 요청 발송"]
  B --|"아니오"| D["사용자에게 필드 배치 요구"]
  C --> E{"모든 서명 완료 확인"}
  E --|"예"| F["최종 서명본 생성 및 감사증명서 발행"]
  E --|"아니오"| G["서명 진행 상태 모니터링"]
  G --> C

  subgraph "서명 요청 발송 프로세스"
    H["서명자 이메일/카카오톡 링크 발송"]
  end

  subgraph "서명 입력 방식"
    I["그리기, 텍스트, 도장 입력 지원"]
  end

  F --> J["사용자에게 완료 알림 및 문서 다운로드 제공"]
```


> This document provides business requirements only. All technical implementation decisions belong to developers. Developers have full autonomy over architecture, APIs, and database design. The document describes WHAT the system should do, not HOW to build it.