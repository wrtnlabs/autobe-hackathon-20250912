import { tags } from "typia";

/**
 * ATS Data Access/Audit Log Record. Captures a single event of sensitive data
 * access for audit and regulatory traceability.
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type IAtsRecruitmentAccessLog = {
  /** Unique primary key for the access log entry. */
  id: string & tags.Format<"uuid">;

  /**
   * Actor/user (applicant, HR, reviewer, admin, or system) performing access
   * (UUID).
   *
   * Referenced but not strictly FK-constrained (for audit resilience)
   */
  actor_id: string & tags.Format<"uuid">;

  /**
   * Role of actor at time of access (applicant, hrRecruiter, techReviewer,
   * systemAdmin, system component).
   */
  actor_type: string;

  /**
   * Target data class (e.g. resume, application, interview, notification,
   * credentials, etc).
   */
  target_type: string;

  /** UUID of the business data record being accessed. */
  target_id: string & tags.Format<"uuid">;

  /**
   * Timestamp when access event occurred (ISO8601, UTC, precise to seconds or
   * milliseconds).
   */
  accessed_at: string & tags.Format<"date-time">;

  /** IP address of the requester (may be null if unknown). */
  ip_address?: string | null | undefined;

  /**
   * Device information/user-agent for the accessor (may be null if not
   * captured).
   */
  device_info?: string | null | undefined;

  /** Reason/purpose for access (normal operation, audit, compliance, support). */
  access_reason?: string | null | undefined;
};
export namespace IAtsRecruitmentAccessLog {
  /**
   * Request DTO for searching and paginating access logs in the ATS system.
   * Used to query system-wide or actor-specific access events in a compliant,
   * auditable manner.
   */
  export type IRequest = {
    /**
     * The actor type (e.g. applicant, hrRecruiter, techReviewer,
     * systemAdmin, or system). Can be used for filtering logs per user
     * class.
     */
    actor_type?: string | undefined;

    /** Start of date/time range for filtering (ISO8601 date-time string). */
    accessed_at_from?: (string & tags.Format<"date-time">) | undefined;

    /** End of date/time range for filtering (ISO8601 date-time string). */
    accessed_at_to?: (string & tags.Format<"date-time">) | undefined;

    /**
     * Target data type (e.g. resume, application, interview,
     * api_credential) to filter log scope.
     */
    target_type?: string | undefined;

    /**
     * String to match against actor_id (UUID format) for direct user
     * lookup.
     */
    actor_id?: string | undefined;

    /** String to match against IP (partial or exact). */
    ip_address?: string | undefined;

    /** String to match device_info field (partial or full text). */
    device_info?: string | undefined;

    /** Search in access_reason field (for audit context, event purpose). */
    access_reason?: string | undefined;

    /** Page of results to retrieve (for pagination). Starts at 1. */
    page?: (number & tags.Type<"int32"> & tags.Minimum<1>) | undefined;

    /** Max records per page (limit); typically up to 100. */
    limit?: (number & tags.Type<"int32"> & tags.Minimum<1>) | undefined;
  };

  /**
   * Summary information about a single access-log event for sensitive data
   * access in the ATS. Used by compliance and forensic audit tools to track
   * who, when, and why key system records were accessed. Includes timeline,
   * actor, resource identifiers, minimal device/network context, and optional
   * access reason.
   */
  export type ISummary = {
    /** Unique identifier (UUID) for the access log record. */
    id: string & tags.Format<"uuid">;

    /**
     * ID of the actor (user/admin/system) who accessed the data (may point
     * to deleted actors for audit resilience).
     */
    actor_id: string & tags.Format<"uuid">;

    /**
     * Role or system process that performed the access (applicant,
     * hrRecruiter, techReviewer, systemAdmin, system process, etc).
     */
    actor_type: string;

    /**
     * Resource/data class or entity type being accessed (e.g., resume,
     * application, interview, notification, export job, credentials,
     * etc.).
     */
    target_type: string;

    /**
     * Primary identifier (UUID) of the sensitive ATS data record that was
     * accessed.
     */
    target_id: string & tags.Format<"uuid">;

    /** Timestamp of the access event in UTC (audit field, never null). */
    accessed_at: string & tags.Format<"date-time">;

    /**
     * Optional IP address of the actor/device from which the access
     * originated. Used for access trace and breach investigations.
     */
    ip_address?: string | null | undefined;

    /** Optional device/browser or system user agent string, if available. */
    device_info?: string | null | undefined;

    /**
     * Reason for access, system or business context (normal operation,
     * compliance audit, anomaly investigation, etc.), if provided.
     */
    access_reason?: string | null | undefined;
  };
}
