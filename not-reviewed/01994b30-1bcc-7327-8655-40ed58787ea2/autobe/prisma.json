{"files":[{"filename":"schema-01-systematic.prisma","namespace":"Systematic","models":[{"name":"creverse_ai_essay_tenants","description":"Multi-tenant organizations representing independent educational clients. Each tenant is the top-level owner for schools, users, and configuration. Manages billing, contact, and operational metadata for tenant isolation and multi-tenancy enforcement.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"name","type":"string","nullable":false,"description":"Tenant name for identification."},{"name":"billing_email","type":"string","nullable":true,"description":"Email address for billing and contact."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of tenant creation."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last tenant update."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp of soft deletion."}],"uniqueIndexes":[{"fieldNames":["name"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at","name"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_schools","description":"Schools represent educational institutions within a tenant. Each school belongs to one tenant and manages its own classes and teaching staff. Enforces tenant isolation for multi-tenant architectures.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant's {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"name","type":"string","nullable":false,"description":"School's name within the tenant's organization."},{"name":"region_code","type":"string","nullable":true,"description":"ISO region code for localization and filtering."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of school creation."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last school update."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp of soft deletion."}],"uniqueIndexes":[{"fieldNames":["tenant_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","created_at"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"creverse_ai_essay_classes","description":"Classes represent academic groups within a school used for organizing students and teachers. Each class belongs to a single school and tenant and serves as a scope for essay assignments and grading.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant's {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"school_id","type":"uuid","description":"Belonged school's {@link creverse_ai_essay_schools.id}.","relation":{"name":"school","targetModel":"creverse_ai_essay_schools"},"unique":false,"nullable":false}],"plainFields":[{"name":"name","type":"string","nullable":false,"description":"Class name or code within the school."},{"name":"start_date","type":"datetime","nullable":true,"description":"Scheduled start date of the class."},{"name":"end_date","type":"datetime","nullable":true,"description":"Scheduled end date of the class."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of class creation."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last class update."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp of soft deletion."}],"uniqueIndexes":[{"fieldNames":["tenant_id","school_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","school_id","created_at"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"creverse_ai_essay_api_keys","description":"API keys associated with tenants for scoped programmatic access. Keys include usage quotas, types, states, and expiration for security and operational governance.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant's {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"name","type":"string","nullable":false,"description":"Descriptive name of the API key."},{"name":"key","type":"string","nullable":false,"description":"The opaque API key string used for authentication."},{"name":"type","type":"string","nullable":false,"description":"API key type (e.g., 'read-only', 'full-access')."},{"name":"status","type":"string","nullable":false,"description":"Current operational status of the API key."},{"name":"quota_calls","type":"int","nullable":false,"description":"Monthly API call quota for rate limiting."},{"name":"quota_calls_daily","type":"int","nullable":false,"description":"Daily API call quota for rate limiting."},{"name":"expiry_at","type":"datetime","nullable":true,"description":"Expiration timestamp after which the key is disabled."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of API key creation."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last API key update."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp of soft deletion."}],"uniqueIndexes":[{"fieldNames":["tenant_id","key"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","status"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"creverse_ai_essay_feature_flags","description":"Feature flags that enable or disable functionality at tenant or system scope. Flags include keys, descriptions, statuses, and value representations supporting dynamic configuration.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant's {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":true}],"plainFields":[{"name":"key","type":"string","nullable":false,"description":"Unique feature flag key identifier."},{"name":"description","type":"string","nullable":true,"description":"Description of the feature's purpose."},{"name":"status","type":"string","nullable":false,"description":"Current status of the feature flag (e.g., 'enabled', 'disabled')."},{"name":"value","type":"string","nullable":true,"description":"String representation of the flag's value, e.g., true/false/json."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of feature flag creation."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last feature flag update."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp of soft deletion."}],"uniqueIndexes":[{"fieldNames":["tenant_id","key"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","status"]}],"ginIndexes":[{"fieldName":"key"}]},{"name":"creverse_ai_essay_settings","description":"General system and tenant-specific settings for configurable platform behavior and feature toggles. Settings allow key-value configuration with optional JSON values per tenant.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant's {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":true}],"plainFields":[{"name":"key","type":"string","nullable":false,"description":"Setting key identifier."},{"name":"value","type":"string","nullable":true,"description":"String or JSON encoded value for the setting."},{"name":"description","type":"string","nullable":true,"description":"Human-readable description of the setting purpose."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the setting was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the setting was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp of soft deletion."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["tenant_id","key"]}],"ginIndexes":[{"fieldName":"key"}]}]},{"filename":"schema-02-actors.prisma","namespace":"Actors","models":[{"name":"creverse_ai_essay_guest","description":"Guest user entities represent unauthenticated or minimal-permission users with access primarily to login and public information. Linked to tenants for multi-tenant scoping. Authentication fields include optional password_hash for tracking login credentials. Includes status and soft delete for lifecycle management.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant's {@link creverse_ai_essay_tenants.id} to enforce multi-tenancy scoping.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"email","type":"string","description":"Email address used for login and notifications.","nullable":false},{"name":"password_hash","type":"string","description":"Password hash for authentication login.","nullable":true},{"name":"nickname","type":"string","description":"User's display nickname for personalization and identification.","nullable":true},{"name":"status","type":"string","description":"Account status indicating lifecycle state such as active, suspended, or disabled.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp indicating if user is deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","email"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","created_at"]}],"ginIndexes":[{"fieldName":"nickname"}]},{"name":"creverse_ai_essay_student","description":"Student user entities represent learners submitting essays and viewing personal grading results. Scoped per tenant and optionally associated with classes for enrollment. Stores authentication credentials, personal display info, status, and audit timestamps.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant's {@link creverse_ai_essay_tenants.id} for scoping.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"class_id","type":"uuid","description":"Associated class {@link creverse_ai_essay_classes.id} for student enrollment.","relation":{"name":"class","targetModel":"creverse_ai_essay_classes"},"unique":false,"nullable":true}],"plainFields":[{"name":"email","type":"string","description":"Email address for student login and notifications.","nullable":false},{"name":"password_hash","type":"string","description":"Password hash for authentication login.","nullable":true},{"name":"nickname","type":"string","description":"Preferred display nickname of the student.","nullable":true},{"name":"status","type":"string","description":"Account status such as active, suspended, or disabled.","nullable":false},{"name":"created_at","type":"datetime","description":"Account creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp for marking deletion without actual data removal.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","email"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","class_id","created_at"]}],"ginIndexes":[{"fieldName":"nickname"}]},{"name":"creverse_ai_essay_teacher","description":"Teacher user entities represent educators managing rubrics, assignments, plagiarism reviews, and reports. Scoped by tenant and optionally linked to classes they teach. Authentication stored via password_hash. Account lifecycle and soft deletion supported.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Belonged tenant {@link creverse_ai_essay_tenants.id} for multi-tenancy.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"class_id","type":"uuid","description":"Class {@link creverse_ai_essay_classes.id} associated with this teacher if applicable.","relation":{"name":"class","targetModel":"creverse_ai_essay_classes"},"unique":false,"nullable":true}],"plainFields":[{"name":"email","type":"string","description":"Email address for teacher login and notifications.","nullable":false},{"name":"password_hash","type":"string","description":"Authentication password hash.","nullable":true},{"name":"nickname","type":"string","description":"Display nickname or name for the teacher user.","nullable":true},{"name":"status","type":"string","description":"Lifecycle status of the teacher account.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of account creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete flag timestamp for account deactivation.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","email"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","class_id","created_at"]}],"ginIndexes":[{"fieldName":"nickname"}]},{"name":"creverse_ai_essay_analyst","description":"Analyst user entities represent read-only analytical users accessing reports, audits, and costs. Scoped to tenants, but typically no class association. Include authentication credentials and lifecycle management.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant to which analyst belongs {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"email","type":"string","description":"Email used for login and notifications.","nullable":false},{"name":"password_hash","type":"string","description":"Password hash for authentication.","nullable":true},{"name":"nickname","type":"string","description":"Optional display nickname of the analyst.","nullable":true},{"name":"status","type":"string","description":"Current status of the analyst's account.","nullable":false},{"name":"created_at","type":"datetime","description":"Creation timestamp of the user account.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to user info.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp if account is deactivated.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","email"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","created_at"]}],"ginIndexes":[{"fieldName":"nickname"}]},{"name":"creverse_ai_essay_admin","description":"Admin user entities have full control over tenants, API keys, features, audits, and system ops. Scoped per tenant. Authentication managed via password_hash. Soft delete and status track account lifecycle.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant to which admin belongs {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"email","type":"string","description":"Email address for login and notifications.","nullable":false},{"name":"password_hash","type":"string","description":"Password hash used for authentication.","nullable":true},{"name":"nickname","type":"string","description":"Administrator nickname or display name.","nullable":true},{"name":"status","type":"string","description":"Lifecycle status of the admin account such as active or suspended.","nullable":false},{"name":"created_at","type":"datetime","description":"Account creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Last update timestamp to the admin record.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft delete timestamp marking account deactivation.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","email"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","created_at"]}],"ginIndexes":[{"fieldName":"nickname"}]}]},{"filename":"schema-03-rubrics.prisma","namespace":"Rubrics","models":[{"name":"creverse_ai_essay_rubric_templates","description":"Defines rubric templates as the blueprint for essay grading rubrics owned by tenants. They consist of metadata including tenant reference, name, language, scope, and timestamps. These templates are managed independently by users and serve as the basis for immutable rubric versions.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"References the tenant owning this rubric template. {@link creverse_ai_essay_tenants.id}","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"name","type":"string","nullable":false,"description":"Unique name of the rubric template within the tenant scope."},{"name":"language","type":"string","nullable":false,"description":"Language code for the rubric template (e.g., en, fr)."},{"name":"scope","type":"string","nullable":false,"description":"Scope of the rubric template such as class, school, tenant, or global."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of rubric template creation."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last rubric template update."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp if the template is removed."}],"uniqueIndexes":[{"fieldNames":["tenant_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_rubric_versions","description":"Represents immutable rubric versions created from templates. Each version contains weighted criteria, anchors, guardrails, and lifecycle status such as draft, published, or deprecated. Published versions are immutable. Users may manage versions independently requiring dedicated API endpoints.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"creverse_ai_essay_rubric_template_id","type":"uuid","description":"Foreign key link to parent rubric template. {@link creverse_ai_essay_rubric_templates.id}","relation":{"name":"rubricTemplate","targetModel":"creverse_ai_essay_rubric_templates"},"unique":false,"nullable":false}],"plainFields":[{"name":"version","type":"int","nullable":false,"description":"Sequential version number of this rubric within the template."},{"name":"status","type":"string","nullable":false,"description":"Version lifecycle status, e.g. draft, published, deprecated."},{"name":"description","type":"string","nullable":true,"description":"Optional text description of this rubric version."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of version creation."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last version update."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp if this version is removed."}],"uniqueIndexes":[{"fieldNames":["creverse_ai_essay_rubric_template_id","version"],"unique":true}],"plainIndexes":[{"fieldNames":["creverse_ai_essay_rubric_template_id","status"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_rubric_criteria","description":"Criteria define the individual grading components within each rubric version. Each criterion has a unique key within the rubric version and descriptive text. This subsidiary entity is dependent on rubric versions and is managed through the version API.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"creverse_ai_essay_rubric_version_id","type":"uuid","description":"Parent rubric version foreign key. {@link creverse_ai_essay_rubric_versions.id}","relation":{"name":"rubricVersion","targetModel":"creverse_ai_essay_rubric_versions"},"unique":false,"nullable":false}],"plainFields":[{"name":"key","type":"string","nullable":false,"description":"Unique key for this criterion within the rubric version."},{"name":"description","type":"string","nullable":true,"description":"Optional descriptive text for the criterion."},{"name":"created_at","type":"datetime","nullable":false,"description":"Criterion creation date."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Criterion update date."}],"uniqueIndexes":[{"fieldNames":["creverse_ai_essay_rubric_version_id","key"],"unique":true}],"plainIndexes":[{"fieldNames":["creverse_ai_essay_rubric_version_id"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_rubric_anchors","description":"Anchors define grading anchor points connected to rubric criteria, marking minimum, maximum, or intermediate scale values. This subsidiary table belongs to rubric criteria and is managed through rubric APIs.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"creverse_ai_essay_rubric_criterion_id","type":"uuid","description":"Foreign key to rubric criterion. {@link creverse_ai_essay_rubric_criteria.id}","relation":{"name":"rubricCriterion","targetModel":"creverse_ai_essay_rubric_criteria"},"unique":false,"nullable":false}],"plainFields":[{"name":"label","type":"string","nullable":false,"description":"Text label for the anchor point."},{"name":"scale_value","type":"int","nullable":false,"description":"Integer scale value representing the anchor on the scoring scale."},{"name":"created_at","type":"datetime","nullable":false,"description":"Date-time anchor created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Date-time anchor last updated."}],"uniqueIndexes":[{"fieldNames":["creverse_ai_essay_rubric_criterion_id","scale_value"],"unique":true}],"plainIndexes":[{"fieldNames":["creverse_ai_essay_rubric_criterion_id"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_rubric_weights","description":"Weights define the importance of each criterion within a rubric version, used in overall scoring calculations. Weights tie rubric versions and criteria as foreign keys, with a double precision weight field.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"creverse_ai_essay_rubric_version_id","type":"uuid","description":"Foreign key to rubric version. {@link creverse_ai_essay_rubric_versions.id}","relation":{"name":"rubricVersion","targetModel":"creverse_ai_essay_rubric_versions"},"unique":false,"nullable":false},{"name":"creverse_ai_essay_rubric_criterion_id","type":"uuid","description":"Foreign key to rubric criterion. {@link creverse_ai_essay_rubric_criteria.id}","relation":{"name":"rubricCriterion","targetModel":"creverse_ai_essay_rubric_criteria"},"unique":false,"nullable":false}],"plainFields":[{"name":"weight","type":"double","nullable":false,"description":"Weight factor indicating criterion significance."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp weight record created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp weight record last updated."}],"uniqueIndexes":[{"fieldNames":["creverse_ai_essay_rubric_version_id","creverse_ai_essay_rubric_criterion_id"],"unique":true}],"plainIndexes":[{"fieldNames":["creverse_ai_essay_rubric_version_id"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_rubric_guardrails","description":"Guardrails impose constraints on rubric versions including allowed languages, minimum token counts, maximum repetitions, and linked banned phrases. This subsidiary entity supports enforcement during grading and essay validation.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"creverse_ai_essay_rubric_version_id","type":"uuid","description":"Foreign key to rubric version. {@link creverse_ai_essay_rubric_versions.id}","relation":{"name":"rubricVersion","targetModel":"creverse_ai_essay_rubric_versions"},"unique":false,"nullable":false}],"plainFields":[{"name":"min_tokens","type":"int","nullable":true,"description":"Optional minimum token count required in essays."},{"name":"max_repetitions","type":"int","nullable":true,"description":"Optional maximum number of repeated tokens allowed."},{"name":"allowed_languages","type":"string","nullable":true,"description":"Comma separated allowed language codes for essay submissions."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp guardrail created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp guardrail updated."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["creverse_ai_essay_rubric_version_id"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_rubric_banned_phrases","description":"Banned phrases linked to rubric guardrails, used to flag or disallow essay text. Each phrase must be unique per guardrail context and timestamped for auditing.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"creverse_ai_essay_rubric_guardrail_id","type":"uuid","description":"Foreign key to related rubric guardrail. {@link creverse_ai_essay_rubric_guardrails.id}","relation":{"name":"guardrail","targetModel":"creverse_ai_essay_rubric_guardrails"},"unique":false,"nullable":false}],"plainFields":[{"name":"phrase","type":"string","nullable":false,"description":"Banned phrase text content."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the banned phrase was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the banned phrase was last updated."}],"uniqueIndexes":[{"fieldNames":["creverse_ai_essay_rubric_guardrail_id","phrase"],"unique":true}],"plainIndexes":[{"fieldNames":["creverse_ai_essay_rubric_guardrail_id"]}],"ginIndexes":[]}]},{"filename":"schema-04-essays.prisma","namespace":"Essays","models":[{"name":"creverse_ai_essay_essays","description":"Contains essay submissions representing individual essays submitted by students within tenants and classes. Links to tenant, student, and optionally class. Tracks essay language, status, and related metadata to support grading workflows. Contains created_at, updated_at and optional deleted_at timestamps for audit and soft delete support. Acts as a primary business entity for independent CRUD operations.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant to which this essay belongs. {@link creverse_ai_essay_tenants.id}","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"student_id","type":"uuid","description":"Student who submitted the essay. {@link creverse_ai_essay_student.id}","relation":{"name":"student","targetModel":"creverse_ai_essay_student"},"unique":false,"nullable":false},{"name":"class_id","type":"uuid","description":"Class associated with this essay, optional. {@link creverse_ai_essay_classes.id}","relation":{"name":"class","targetModel":"creverse_ai_essay_classes"},"unique":false,"nullable":true}],"plainFields":[{"name":"status","type":"string","description":"Current status of the essay submission, e.g., 'received', 'processing', or 'graded'.","nullable":false},{"name":"language","type":"string","description":"Language code of the essay, following BCP 47 standard, e.g., 'en-US'.","nullable":false},{"name":"title","type":"string","description":"Optional title of the essay, provided by student or system.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the essay was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the essay was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Optional timestamp when the essay was soft deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","student_id","id"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","student_id","created_at"]},{"fieldNames":["status","created_at"]}],"ginIndexes":[{"fieldName":"title"}]},{"name":"creverse_ai_essay_essay_versions","description":"Represents different versions of essays including original, normalized, and OCR processed texts. Each version links to a parent essay, tracks language, normalized flags, and text length. Supports audit trail via created_at and updated_at timestamps. Primary entity for versioned textual content supporting grading and analysis.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"essay_id","type":"uuid","description":"Parent essay to which this version belongs. {@link creverse_ai_essay_essays.id}","relation":{"name":"essay","targetModel":"creverse_ai_essay_essays"},"unique":false,"nullable":false}],"plainFields":[{"name":"language","type":"string","description":"Language code for this essay version, BCP 47 format, e.g., 'en-US'.","nullable":false},{"name":"normalized","type":"boolean","description":"Indicates whether this text version is normalized for consistent grading.","nullable":false},{"name":"ocr","type":"boolean","description":"True if this version was created via OCR processing of original file.","nullable":false},{"name":"text_length","type":"int","description":"Length of the essay text in tokens or characters.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of version creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to this version, typically immutable after creation.","nullable":false}],"uniqueIndexes":[{"fieldNames":["essay_id","id"],"unique":true}],"plainIndexes":[{"fieldNames":["essay_id","created_at"]}],"ginIndexes":[{"fieldName":"language"}]},{"name":"creverse_ai_essay_essay_blobs","description":"Stores references to file artifacts related to essays such as original uploads, OCR source files, or normalized text files. Linked to essays by foreign keys. Supports audit timestamps and soft deletion. Subsidiary entity supporting storage and retrieval of essay-related binary blobs.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"essay_id","type":"uuid","description":"Essay related to this blob. {@link creverse_ai_essay_essays.id}","relation":{"name":"essay","targetModel":"creverse_ai_essay_essays"},"unique":false,"nullable":false}],"plainFields":[{"name":"blob_uri","type":"uri","description":"URI referencing the location of the stored blob artifact, typically Azure Blob Storage SAS URL.","nullable":false},{"name":"blob_type","type":"string","description":"Type of the blob artifact, e.g., 'original', 'normalized', 'ocr'.","nullable":false},{"name":"content_type","type":"string","description":"MIME content type of the stored blob, e.g., 'application/pdf', 'text/plain'.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the blob entry was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the blob entry was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Optional timestamp for soft deletion.","nullable":true}],"uniqueIndexes":[{"fieldNames":["essay_id","blob_uri"],"unique":true}],"plainIndexes":[{"fieldNames":["blob_type","content_type"]}],"ginIndexes":[]}]},{"filename":"schema-05-grading.prisma","namespace":"Grading","models":[{"name":"creverse_ai_essay_grading_jobs","description":"Represents asynchronous grading jobs binding an essay version and rubric version. Stores job status, cancellation flags, error messages, timestamps, and associations to tenants and users. Supports retry logic and job lifecycle management including queued, processing, succeeded, failed, and cancelled states.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Associated tenant's {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"student_id","type":"uuid","description":"Associated student's {@link creverse_ai_essay_student.id}.","relation":{"name":"student","targetModel":"creverse_ai_essay_student"},"unique":false,"nullable":true},{"name":"teacher_id","type":"uuid","description":"Associated teacher's {@link creverse_ai_essay_teacher.id}.","relation":{"name":"teacher","targetModel":"creverse_ai_essay_teacher"},"unique":false,"nullable":true},{"name":"rubric_version_id","type":"uuid","description":"Target rubric version {@link creverse_ai_essay_rubric_versions.id} for grading.","relation":{"name":"rubricVersion","targetModel":"creverse_ai_essay_rubric_versions"},"unique":false,"nullable":false},{"name":"essay_version_id","type":"uuid","description":"Target essay version {@link creverse_ai_essay_essay_versions.id} for grading.","relation":{"name":"essayVersion","targetModel":"creverse_ai_essay_essay_versions"},"unique":false,"nullable":false}],"plainFields":[{"name":"status","type":"string","description":"Current job status such as queued, processing, succeeded, failed, or cancelled.","nullable":false},{"name":"is_cancelled","type":"boolean","description":"Flag indicating if job cancellation was requested.","nullable":false},{"name":"error_code","type":"string","description":"Error code if the job failed or was cancelled, null if no error.","nullable":true},{"name":"error_message","type":"string","description":"Detailed error message if any, null if none.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the job was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the job record was last updated.","nullable":false},{"name":"started_at","type":"datetime","description":"Timestamp when job processing started, null before processing.","nullable":true},{"name":"completed_at","type":"datetime","description":"Timestamp when job processing completed, null if not finished.","nullable":true},{"name":"retry_count","type":"int","description":"Number of retry attempts performed for the job.","nullable":false}],"uniqueIndexes":[{"fieldNames":["tenant_id","essay_version_id","rubric_version_id"],"unique":true}],"plainIndexes":[{"fieldNames":["status","updated_at"]}],"ginIndexes":[{"fieldName":"error_message"}]},{"name":"creverse_ai_essay_grading_results","description":"Stores detailed scoring results for a completed grading job. Includes overall rubric score, raw rubric score, normalized score, and associations to grading job and rubric version. Supports strict referential integrity and auditability.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"grading_job_id","type":"uuid","description":"Associated grading job {@link creverse_ai_essay_grading_jobs.id}.","relation":{"name":"gradingJob","targetModel":"creverse_ai_essay_grading_jobs"},"unique":false,"nullable":false},{"name":"rubric_version_id","type":"uuid","description":"The rubric version {@link creverse_ai_essay_rubric_versions.id} used for scoring.","relation":{"name":"rubricVersion","targetModel":"creverse_ai_essay_rubric_versions"},"unique":false,"nullable":false}],"plainFields":[{"name":"raw_rubric_score","type":"double","description":"Raw rubric score prior to normalization and calibration.","nullable":false},{"name":"rubric_score","type":"double","description":"Normalized rubric score scaled to 0-100 based on rubric scale boundaries.","nullable":false},{"name":"calibrated_score","type":"double","description":"Final calibrated score after applying length penalty and other adjustments.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp of result creation.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of last update to the result.","nullable":false}],"uniqueIndexes":[{"fieldNames":["grading_job_id"],"unique":true}],"plainIndexes":[{"fieldNames":["rubric_version_id"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_grading_feedback","description":"Stores per-criteria qualitative feedback entries for a given grading result. Linked to grading results for comprehensive review and analytics.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"grading_result_id","type":"uuid","description":"Associated grading result {@link creverse_ai_essay_grading_results.id}.","relation":{"name":"gradingResult","targetModel":"creverse_ai_essay_grading_results"},"unique":false,"nullable":false}],"plainFields":[{"name":"criteria_key","type":"string","description":"Unique key for the rubric criteria this feedback refers to.","nullable":false},{"name":"criteria_name","type":"string","description":"Human-readable name of the rubric criteria.","nullable":false},{"name":"body","type":"string","description":"Textual feedback for the criteria.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["criteria_key"]}],"ginIndexes":[{"fieldName":"body"}]},{"name":"creverse_ai_essay_grading_calibrations","description":"Captures calibration details for grading results including length penalties and CEFR adjustments. Supports auditability and historical reference.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"grading_result_id","type":"uuid","description":"Associated grading result {@link creverse_ai_essay_grading_results.id}.","relation":{"name":"gradingResult","targetModel":"creverse_ai_essay_grading_results"},"unique":true,"nullable":false}],"plainFields":[{"name":"length_penalty","type":"double","description":"Applied length penalty value.","nullable":false},{"name":"target_cefr_level","type":"string","description":"Target Common European Framework of Reference (CEFR) level for score calibration, null if not applied.","nullable":true},{"name":"calibration_notes","type":"string","description":"Optional notes describing the calibration.","nullable":true}],"uniqueIndexes":[{"fieldNames":["grading_result_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[]},{"name":"creverse_ai_essay_scoring_options","description":"Options and parameters used to configure scoring behavior per grading job such as tone, normalization, and calibration directives.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"grading_job_id","type":"uuid","description":"The grading job {@link creverse_ai_essay_grading_jobs.id} this scoring option is linked to.","relation":{"name":"gradingJob","targetModel":"creverse_ai_essay_grading_jobs"},"unique":true,"nullable":false}],"plainFields":[{"name":"tone","type":"string","description":"Requested tone for scoring feedback (e.g., formal, friendly).","nullable":true},{"name":"normalize_scores","type":"boolean","description":"Flag to apply normalization to raw rubric scores.","nullable":false},{"name":"apply_calibration","type":"boolean","description":"Flag to enable score calibration adjustments.","nullable":false}],"uniqueIndexes":[{"fieldNames":["grading_job_id"],"unique":true}],"plainIndexes":[],"ginIndexes":[]},{"name":"creverse_ai_essay_model_metadata","description":"Metadata about each AI model invocation for grading jobs, including token counts, model version, latency, and cost for audit and cost governance.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"grading_job_id","type":"uuid","description":"Associated grading job {@link creverse_ai_essay_grading_jobs.id}.","relation":{"name":"gradingJob","targetModel":"creverse_ai_essay_grading_jobs"},"unique":false,"nullable":false}],"plainFields":[{"name":"model_name","type":"string","description":"The name of the AI model invoked for scoring.","nullable":false},{"name":"model_version","type":"string","description":"Specific version tag of the AI model used.","nullable":false},{"name":"token_count","type":"int","description":"Number of tokens consumed during the model call.","nullable":false},{"name":"latency_ms","type":"int","description":"Latency in milliseconds for the model call.","nullable":false},{"name":"cost_usd","type":"double","description":"Cost in USD charged for the model call.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when this metadata record was created.","nullable":false}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["model_name"]}],"ginIndexes":[]}]},{"filename":"schema-06-plagiarism.prisma","namespace":"Plagiarism","models":[{"name":"creverse_ai_essay_plagiarism_providers","description":"Plagiarism detection providers metadata, including service name, URLs, and operational status. Supports asynchronous scans by various plagiarism engines within CREVERSE AI multi-tenant architecture. No independent user management APIs; managed as a solitary supporting entity.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"tenant_id","type":"uuid","nullable":false,"description":"Tenant owning the plagiarism provider configuration. {@link creverse_ai_essay_tenants.id}"},{"name":"name","type":"string","nullable":false,"description":"Unique name identifier of the plagiarism provider service, e.g., \"Turnitin\", \"CustomInternal\""},{"name":"base_uri","type":"uri","nullable":false,"description":"Base URI endpoint for contacting the plagiarism provider"},{"name":"enabled","type":"boolean","nullable":false,"description":"Flag indicating if the plagiarism provider is currently enabled for use"},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when this provider record was created"},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when this provider record was last updated"},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp marking deletion (soft delete) of this provider record"}],"uniqueIndexes":[{"fieldNames":["tenant_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","enabled"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"creverse_ai_essay_plagiarism_scans","description":"Records of plagiarism scan requests and results, each linked to a tenant and a specific essay version. Captures scan lifecycle state, provider used, result metadata, errors, and timing for asynchronous plagiarism detection integration.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","nullable":false,"description":"Owning tenant of the plagiarism scan. {@link creverse_ai_essay_tenants.id}","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false},{"name":"essay_version_id","type":"uuid","nullable":false,"description":"Referenced essay version being scanned. {@link creverse_ai_essay_essay_versions.id}","relation":{"name":"essayVersion","targetModel":"creverse_ai_essay_essay_versions"},"unique":false},{"name":"plagiarism_provider_id","type":"uuid","nullable":true,"description":"Plagiarism provider used for this scan. {@link creverse_ai_essay_plagiarism_providers.id}","relation":{"name":"plagiarismProvider","targetModel":"creverse_ai_essay_plagiarism_providers"},"unique":false}],"plainFields":[{"name":"status","type":"string","nullable":false,"description":"Status of the scan, e.g., \"pending\", \"processing\", \"completed\", \"failed\""},{"name":"progress","type":"int","nullable":false,"description":"Percentage progress of the scan operation, 0-100"},{"name":"result_url","type":"uri","nullable":true,"description":"URL to the detailed plagiarism scan results, if available"},{"name":"error_code","type":"string","nullable":true,"description":"Optional error code if the scan failed"},{"name":"started_at","type":"datetime","nullable":true,"description":"Timestamp when the scan started"},{"name":"completed_at","type":"datetime","nullable":true,"description":"Timestamp when the scan completed"},{"name":"created_at","type":"datetime","nullable":false,"description":"Record created timestamp"},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last updated timestamp"},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp"}],"uniqueIndexes":[{"fieldNames":["tenant_id","essay_version_id","plagiarism_provider_id"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","status"]},{"fieldNames":["plagiarism_provider_id","status"]}],"ginIndexes":[{"fieldName":"error_code"}]},{"name":"creverse_ai_essay_plagiarism_matches","description":"Historical snapshots of individual plagiarism matches detected per plagiarism scan. Stores matched source spans, similarity scores, matched text excerpts, and reference URIs for audit and investigation. Immutable once created for audit compliance.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"plagiarism_scan_id","type":"uuid","nullable":false,"description":"Parent plagiarism scan. {@link creverse_ai_essay_plagiarism_scans.id}","relation":{"name":"plagiarismScan","targetModel":"creverse_ai_essay_plagiarism_scans"},"unique":false}],"plainFields":[{"name":"match_score","type":"double","nullable":false,"description":"Similarity score for this match, e.g., 0.0â€“100.0 percentage"},{"name":"source_uri","type":"uri","nullable":true,"description":"URI of the matched source document or resource"},{"name":"source_start_char","type":"int","nullable":false,"description":"Inclusive start character offset of the matched text in the source"},{"name":"source_end_char","type":"int","nullable":false,"description":"Inclusive end character offset of the matched text in the source"},{"name":"matched_text","type":"string","nullable":true,"description":"Extracted matched text snippet for audit display"},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when this match was recorded"},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when this match record was last updated"},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp"}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["match_score"]}],"ginIndexes":[{"fieldName":"matched_text"}]}]},{"filename":"schema-07-ocr.prisma","namespace":"Ocr","models":[{"name":"creverse_ai_essay_ocr_jobs","description":"OCR ingestion jobs represent asynchronous requests to convert essay blobs such as PDFs or images into text. Each job is uniquely identified by a UUID and associated with a tenant and a source essay blob. The model tracks the OCR processing lifecycle through status fields, optional error messages for diagnostics, start and finish timestamps, and usual created, updated, and soft deletion timestamps. The entity serves as a primary domain object reflecting OCR processing pipeline states independent from essay or grading workflows.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant that owns this OCR job, ensuring strict multi-tenant data isolation. Foreign key references creverse_ai_essay_tenants.id.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"blob_id","type":"uuid","description":"Reference to the essay blob (PDF or image) to process in this OCR job. Foreign key to creverse_ai_essay_essay_blobs.id.","relation":{"name":"blob","targetModel":"creverse_ai_essay_essay_blobs"},"unique":false,"nullable":false}],"plainFields":[{"name":"status","type":"string","description":"Current state of the OCR job such as 'queued', 'processing', 'succeeded', or 'failed'. Enables tracking and workflow management.","nullable":false},{"name":"error_message","type":"string","description":"Optional detailed error message if OCR processing failed. Useful for troubleshooting and retry logic.","nullable":true},{"name":"started_at","type":"datetime","description":"Timestamp when OCR processing started. Null if processing not yet begun.","nullable":true},{"name":"finished_at","type":"datetime","description":"Timestamp when OCR processing completed. Null if job pending or failed.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when this OCR job was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when this OCR job was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp; null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","blob_id"],"unique":true}],"plainIndexes":[{"fieldNames":["status","created_at"]}],"ginIndexes":[{"fieldName":"error_message"}]},{"name":"creverse_ai_essay_ocr_results","description":"OCR results contain extracted text from OCR jobs linked to specific essay versions generated by processing blobs. Each result record uniquely identifies the OCR job it belongs to and the resultant essay version. The model stores the plain text output, optional detected language, and timestamps for creation, updates, and soft deletion. This primary entity supports independent querying and management of OCR results in the essay processing pipeline.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"ocr_job_id","type":"uuid","description":"Foreign key referencing the OCR job that generated this result. Links to creverse_ai_essay_ocr_jobs.id.","relation":{"name":"ocrJob","targetModel":"creverse_ai_essay_ocr_jobs"},"unique":false,"nullable":false},{"name":"essay_version_id","type":"uuid","description":"Foreign key referencing the essay version created from this OCR text. Links to creverse_ai_essay_essay_versions.id.","relation":{"name":"essayVersion","targetModel":"creverse_ai_essay_essay_versions"},"unique":false,"nullable":false}],"plainFields":[{"name":"text","type":"string","description":"Extracted OCR plain text content from essay blobs.","nullable":false},{"name":"language","type":"string","description":"Detected or specified language of the OCR text such as 'en' or 'fr'. Facilitates language-based filtering and processing. Nullable if unknown.","nullable":true},{"name":"created_at","type":"datetime","description":"Timestamp when the OCR result record was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the OCR result record was last updated.","nullable":false},{"name":"deleted_at","type":"datetime","description":"Soft deletion timestamp; null if not deleted.","nullable":true}],"uniqueIndexes":[{"fieldNames":["ocr_job_id"],"unique":true}],"plainIndexes":[{"fieldNames":["language"]}],"ginIndexes":[{"fieldName":"text"}]}]},{"filename":"schema-08-reports.prisma","namespace":"Reports","models":[{"name":"creverse_ai_essay_reports","description":"This table aggregates overall essay grading reports including progress, distribution, and cost governance metrics per tenant, class, and rubric over specified time ranges. It supports filtering by tenant, class, rubric, and time periods and enables efficient read access to analytic rollups for reporting purposes. The table maintains relationships to tenant, class, and rubric entities for scoping. Standard temporal fields track record creation and update times. This table is classified as primary as users query and browse report summaries independently.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant of this report. {@link creverse_ai_essay_tenants.id}","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"class_id","type":"uuid","description":"Class related to report entries. {@link creverse_ai_essay_classes.id}","relation":{"name":"class","targetModel":"creverse_ai_essay_classes"},"unique":false,"nullable":true},{"name":"rubric_version_id","type":"uuid","description":"Specific rubric version referenced in the report. {@link creverse_ai_essay_rubric_versions.id}","relation":{"name":"rubricVersion","targetModel":"creverse_ai_essay_rubric_versions"},"unique":false,"nullable":true}],"plainFields":[{"name":"date_from","type":"datetime","nullable":false,"description":"Start date of the reporting period."},{"name":"date_to","type":"datetime","nullable":false,"description":"End date of the reporting period."},{"name":"total_essays","type":"int","nullable":false,"description":"Total number of essays included in this report."},{"name":"average_score","type":"double","nullable":false,"description":"Average normalized score (0-100 scale) across essays."},{"name":"cost_usd","type":"double","nullable":true,"description":"Reported cost of grading in USD for the period."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."}],"uniqueIndexes":[{"fieldNames":["tenant_id","class_id","rubric_version_id","date_from","date_to"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","class_id","rubric_version_id","date_from"]},{"fieldNames":["tenant_id","class_id","date_to"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_report_snapshots","description":"Historical snapshots of essay reports for audit trails and trend analysis. Each snapshot captures the state of a specific report at a point in time, preserving data immutability. The snapshots link to the main report entity and tenant. This table supports temporal queries for historical report comparisons and analytics. This is a snapshot table reflecting append-only audit data.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant of this snapshot. {@link creverse_ai_essay_tenants.id}","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"creverse_ai_essay_report_id","type":"uuid","description":"Main report this snapshot refers to. {@link creverse_ai_essay_reports.id}","relation":{"name":"creverseAiEssayReport","targetModel":"creverse_ai_essay_reports"},"unique":false,"nullable":false}],"plainFields":[{"name":"snapshot_at","type":"datetime","nullable":false,"description":"Timestamp when the snapshot was taken."},{"name":"total_essays","type":"int","nullable":false,"description":"Total essays counted in this snapshot."},{"name":"average_score","type":"double","nullable":false,"description":"Average normalized score (0-100 scale)."},{"name":"cost_usd","type":"double","nullable":true,"description":"Cost in USD at snapshot time."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last update timestamp."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["tenant_id","creverse_ai_essay_report_id","snapshot_at"]}],"ginIndexes":[]}]},{"filename":"schema-09-admin.prisma","namespace":"Admin","models":[{"name":"creverse_ai_essay_audit_logs","description":"Audit logs capturing all user and system actions including PII access, changes to rubric, grading operations, and administrative activities. Tracks actor, action type, entity referenced, IP address, and timestamp, ensuring tenant isolation and compliance auditing.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant associated with the audit log. {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false},{"name":"actor_user_id","type":"uuid","description":"User who performed the action, may be null for system events. {@link creverse_ai_essay_admin.id}.","relation":{"name":"actorUser","targetModel":"creverse_ai_essay_admin"},"unique":false,"nullable":true}],"plainFields":[{"name":"action","type":"string","description":"Type of action performed, e.g., rubric_publish, grading_create, pii_access.","nullable":false},{"name":"entity_type","type":"string","description":"Type of entity affected by the action, e.g., rubric_version, essay, user, feature_flag.","nullable":false},{"name":"entity_id","type":"uuid","description":"UUID of the entity affected, if applicable.","nullable":true},{"name":"timestamp","type":"datetime","description":"Timestamp when the action occurred.","nullable":false},{"name":"ip_address","type":"string","description":"IP address from which action was performed, supports IPv4 and IPv6.","nullable":true},{"name":"details","type":"string","description":"Optional JSON string with additional context or metadata about the action.","nullable":true}],"uniqueIndexes":[{"fieldNames":["tenant_id","id"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","timestamp"]}],"ginIndexes":[{"fieldName":"details"}]},{"name":"creverse_ai_essay_webhooks","description":"Webhook configurations for delivering event notifications to external systems. Includes settings for destination URL, secret for signature validation, retry policies, and event filters. Tracks delivery status and error reasons.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Tenant owning the webhook configuration. {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"url","type":"uri","description":"Destination endpoint URL for webhook delivery.","nullable":false},{"name":"secret","type":"string","description":"Secret key for HMAC signature to verify webhook payload integrity.","nullable":true},{"name":"events","type":"string","description":"Comma-separated list of event types that trigger this webhook, e.g., grading.completed, plagiarism.scanned.","nullable":false},{"name":"retry_count","type":"int","description":"Number of retry attempts made after a failure.","nullable":false},{"name":"retry_delay_seconds","type":"int","description":"Delay in seconds before the next retry attempt.","nullable":false},{"name":"last_error","type":"string","description":"Last error message if delivery failed, null if no errors.","nullable":true},{"name":"active","type":"boolean","description":"Indicates if the webhook is currently active and should receive events.","nullable":false},{"name":"created_at","type":"datetime","description":"Webhook configuration creation timestamp.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp of the last update to webhook configuration.","nullable":false}],"uniqueIndexes":[{"fieldNames":["tenant_id","url"],"unique":true}],"plainIndexes":[{"fieldNames":["tenant_id","active"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_system_health","description":"System health check records for tracking uptime and operational status metrics. Captures service names, health status, check timestamps, and optional detailed status information for monitoring and alerting.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"service_name","type":"string","description":"Name of the monitored service or subsystem, e.g. grading_worker, webhook_dispatcher.","nullable":false},{"name":"status","type":"string","description":"Current health status (e.g., healthy, degraded, down).","nullable":false},{"name":"checked_at","type":"datetime","description":"Timestamp when the health check was performed.","nullable":false},{"name":"details","type":"string","description":"Optional JSON string with detailed health check information or metrics.","nullable":true}],"uniqueIndexes":[{"fieldNames":["service_name","checked_at"],"unique":true}],"plainIndexes":[{"fieldNames":["status","checked_at"]}],"ginIndexes":[{"fieldName":"details"}]},{"name":"creverse_ai_essay_feature_flags_history","description":"Historical records of feature flag changes capturing state over time, the author of the change, and reason for changes for audit and rollback capabilities.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"feature_flag_id","type":"uuid","description":"Reference to current feature flag entity. {@link creverse_ai_essay_feature_flags.id}.","relation":{"name":"featureFlag","targetModel":"creverse_ai_essay_feature_flags"},"unique":false,"nullable":false}],"plainFields":[{"name":"changed_at","type":"datetime","description":"Timestamp when this change occurred.","nullable":false},{"name":"changed_by_user_id","type":"uuid","description":"User who made the change. {@link creverse_ai_essay_admin.id}.","nullable":true},{"name":"previous_value","type":"string","description":"Feature flag value before the change, stored as a JSON string.","nullable":true},{"name":"new_value","type":"string","description":"Feature flag value after the change, stored as a JSON string.","nullable":true},{"name":"change_reason","type":"string","description":"Text explaining the reason for the feature flag change.","nullable":true}],"uniqueIndexes":[{"fieldNames":["feature_flag_id","changed_at"],"unique":true}],"plainIndexes":[{"fieldNames":["changed_at"]}],"ginIndexes":[]}]},{"filename":"schema-10-cost-governance.prisma","namespace":"CostGovernance","models":[{"name":"creverse_ai_essay_cost_reports","description":"This table captures cost and usage reports related to essay grading activities per tenant for specific time intervals. It records metrics such as token usage, latency, request counts, and cost amounts, enabling budget tracking and financial reporting within the multi-tenant system. It references the tenant entity and is indexed by tenant and report interval for efficient queries.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Reference to the tenant entity. {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"period_start","type":"datetime","nullable":false,"description":"Start timestamp of the reporting period in ISO 8601 format, inclusive."},{"name":"period_end","type":"datetime","nullable":false,"description":"End timestamp of the reporting period in ISO 8601 format, exclusive."},{"name":"token_count","type":"int","nullable":false,"description":"Total number of AI tokens consumed during this period for essay grading."},{"name":"request_count","type":"int","nullable":false,"description":"Total count of essay grading requests processed during this period."},{"name":"average_latency_ms","type":"double","nullable":false,"description":"Average latency in milliseconds for grading requests within this period."},{"name":"total_cost_usd","type":"double","nullable":false,"description":"Total cost in US dollars incurred during the reporting period related to grading activities."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Record last updated timestamp."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp to indicate if the record has been logically deleted."}],"uniqueIndexes":[{"fieldNames":["tenant_id","period_start"],"unique":true}],"plainIndexes":[{"fieldNames":["period_start","period_end","tenant_id"]}],"ginIndexes":[]},{"name":"creverse_ai_essay_auto_throttle_policies","description":"This table defines auto-throttling policies that apply to tenants to control request rates and prevent budget overruns. It stores policy types, thresholds, and actions to enforce limits at runtime. Each policy is uniquely associated with a tenant and a policy type.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"tenant_id","type":"uuid","description":"Reference to the tenant which this throttle policy applies to. {@link creverse_ai_essay_tenants.id}.","relation":{"name":"tenant","targetModel":"creverse_ai_essay_tenants"},"unique":false,"nullable":false}],"plainFields":[{"name":"policy_type","type":"string","nullable":false,"description":"Type of throttling policy, such as 'budget_limit', 'rate_limit', indicating the enforcement scope."},{"name":"threshold_value","type":"double","nullable":false,"description":"Numeric threshold value for the policy, e.g., maximum allowed tokens per time unit or maximum request rate."},{"name":"action","type":"string","nullable":false,"description":"Action to take when the threshold is exceeded, e.g., 'reject', 'warn', or 'throttle'."},{"name":"description","type":"string","nullable":true,"description":"Detailed human-readable explanation of the policy purpose and application."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when this policy record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when this policy record was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp indicating logical deletion."}],"uniqueIndexes":[{"fieldNames":["tenant_id","policy_type"],"unique":true}],"plainIndexes":[{"fieldNames":["policy_type"]}],"ginIndexes":[]}]}]}