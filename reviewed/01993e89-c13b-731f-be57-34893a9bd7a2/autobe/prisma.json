{"files":[{"filename":"schema-01-identity.prisma","namespace":"Identity","models":[{"name":"notification_workflow_workflowmanagers","description":"Workflow manager users responsible for creating, updating, activating, and managing notification workflows. Stores identity and authentication data required for access control. Includes standard audit fields for record management.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","nullable":false,"description":"Unique email address of the workflow manager used for login and notifications."},{"name":"password_hash","type":"string","nullable":false,"description":"Hashed password for authentication; never store plain passwords."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the user record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the user record was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Timestamp for soft deletion; null if the record is active."}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"notification_workflow_triggeroperators","description":"Trigger operator users who create and manage trigger instances for workflows. Stores identity and authentication information with audit timestamps for access control enforcement.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","nullable":false,"description":"Unique email address of the trigger operator, used for user identification and login."},{"name":"password_hash","type":"string","nullable":false,"description":"Hashed password securely stored for authentication."},{"name":"created_at","type":"datetime","nullable":false,"description":"Record creation timestamp for audit trail."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Last update timestamp reflecting modifications."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft delete timestamp marking inactive users; null if active."}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"notification_workflow_systemadmins","description":"System administrator users with full permissions to manage users, workflows, and system settings. Includes authentication credentials and audit timestamps for secure management.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","nullable":false,"description":"Unique email address used by the system administrator for authentication."},{"name":"password_hash","type":"string","nullable":false,"description":"Hashed password for secure authentication."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the admin record was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp of last modification."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp; null indicates active record."}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]},{"name":"notification_workflow_workerservices","description":"Automated worker service users responsible for processing triggers concurrently. Authentication and audit fields included to track service identity and activity.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"email","type":"string","nullable":false,"description":"Unique email identifying the worker service account."},{"name":"password_hash","type":"string","nullable":false,"description":"Hashed password for worker service authentication."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the worker service account was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the worker service account was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp; null for active records."}],"uniqueIndexes":[{"fieldNames":["email"],"unique":true}],"plainIndexes":[{"fieldNames":["created_at"]}],"ginIndexes":[]}]},{"filename":"schema-02-workflows.prisma","namespace":"Workflows","models":[{"name":"notification_workflow_workflows","description":"Represents notification workflows forming the main business entity for orchestrating notification steps. Contains metadata including unique code, name, activation status, versioning, and timestamps. Serves as the root for related workflow nodes and edges. Workflows are DAGs defining notification sequences for emails, SMS, and delays.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","nullable":false,"description":"Unique business identifier code for the workflow."},{"name":"name","type":"string","nullable":false,"description":"Display name of the workflow."},{"name":"is_active","type":"boolean","nullable":false,"description":"Indicates whether the workflow is active and can be triggered."},{"name":"entry_node_id","type":"uuid","nullable":false,"description":"Reference to the starting node of the workflow DAG."},{"name":"version","type":"int","nullable":false,"description":"Version number of the workflow, incremented on updates."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the workflow was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the workflow was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp, null if not deleted."}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true}],"plainIndexes":[{"fieldNames":["is_active","updated_at"]}],"ginIndexes":[]},{"name":"notification_workflow_workflow_nodes","description":"Represents nodes within a notification workflow, each defining a step such as Email, SMS, or Delay. Nodes belong to a parent workflow and can be sequenced via edges. Stores node type discriminator, LiquidJS templates for messages, and delay durations as applicable. Supports validation and lifecycle properties. Managed subsidiary to the workflow entity.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"workflow_id","type":"uuid","description":"Parent workflow's notification_workflow_workflows.id","relation":{"name":"workflow","targetModel":"notification_workflow_workflows"},"unique":false,"nullable":false}],"plainFields":[{"name":"node_type","type":"string","nullable":false,"description":"Type of node indicating Email, SMS, or Delay."},{"name":"name","type":"string","nullable":false,"description":"Display name of the node."},{"name":"email_to_template","type":"string","nullable":true,"description":"LiquidJS template string for email recipient address."},{"name":"email_subject_template","type":"string","nullable":true,"description":"LiquidJS template string for email subject."},{"name":"email_body_template","type":"string","nullable":true,"description":"LiquidJS template string for email body content."},{"name":"sms_to_template","type":"string","nullable":true,"description":"LiquidJS template string for SMS recipient number."},{"name":"sms_body_template","type":"string","nullable":true,"description":"LiquidJS template string for SMS content."},{"name":"delay_ms","type":"int","nullable":true,"description":"Delay in milliseconds for DelayNode steps."},{"name":"delay_duration","type":"string","nullable":true,"description":"ISO 8601 duration string representing delay."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the node was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the node was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp for the node."}],"uniqueIndexes":[{"fieldNames":["workflow_id","name"],"unique":true}],"plainIndexes":[{"fieldNames":["workflow_id","node_type"]}],"ginIndexes":[{"fieldName":"name"}]},{"name":"notification_workflow_workflow_edges","description":"Defines directed edges connecting nodes within notification workflows. Represents the relationships modeling the DAG structure of workflows by linking nodes with 'from' and 'to' references. Ensures graph integrity and no self loops. Managed as subsidiary entity.","material":false,"stance":"subsidiary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"workflow_id","type":"uuid","description":"Parent workflow's notification_workflow_workflows.id","relation":{"name":"workflow","targetModel":"notification_workflow_workflows"},"unique":false,"nullable":false},{"name":"from_node_id","type":"uuid","description":"Source node reference in notification_workflow_workflow_nodes.id","relation":{"name":"fromNode","targetModel":"notification_workflow_workflow_nodes","mappingName":"notification_workflow_workflow_edges_of_from_node_id"},"unique":false,"nullable":false},{"name":"to_node_id","type":"uuid","description":"Target node reference in notification_workflow_workflow_nodes.id","relation":{"name":"toNode","targetModel":"notification_workflow_workflow_nodes","mappingName":"notification_workflow_workflow_edges_of_to_node_id"},"unique":false,"nullable":false}],"plainFields":[{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the edge was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the edge was last updated."},{"name":"deleted_at","type":"datetime","nullable":true,"description":"Soft deletion timestamp for the edge."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["workflow_id","from_node_id","to_node_id"]}],"ginIndexes":[]}]},{"filename":"schema-03-triggers.prisma","namespace":"Triggers","models":[{"name":"notification_workflow_trigger_instances","description":"Stores runtime TriggerInstances for notification workflows representing workflow executions with idempotency key, status, current cursor position, retry attempts, and availability scheduling. References the target workflow and supports lifecycle management and worker processing coordination.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"workflow_id","type":"uuid","description":"Referenced workflow's notification_workflow_workflows.id.","relation":{"name":"workflow","targetModel":"notification_workflow_workflows"},"unique":false,"nullable":false}],"plainFields":[{"name":"idempotency_key","type":"string","description":"Idempotency key to ensure uniqueness and prevent duplicate trigger creation per workflow.","nullable":false},{"name":"cursor_current_node_id","type":"string","description":"Current node id cursor indicating the next node to execute in the workflow DAG.","nullable":true},{"name":"status","type":"string","description":"Status of the trigger instance, enum values: enqueued, processing, completed, failed.","nullable":false},{"name":"attempts","type":"int","description":"Count of execution attempts for retry logic, starting from zero.","nullable":false},{"name":"available_at","type":"datetime","description":"Timestamp indicating when the trigger instance becomes available for processing or retry.","nullable":false},{"name":"payload","type":"string","description":"Input data payload in JSON format for the workflow trigger execution context.","nullable":false},{"name":"created_at","type":"datetime","description":"Timestamp when the TriggerInstance was created.","nullable":false},{"name":"updated_at","type":"datetime","description":"Timestamp when the TriggerInstance was last updated.","nullable":false}],"uniqueIndexes":[{"fieldNames":["workflow_id","idempotency_key"],"unique":true}],"plainIndexes":[{"fieldNames":["workflow_id","status","available_at"]}],"ginIndexes":[]}]},{"filename":"schema-04-workerexecution.prisma","namespace":"WorkerExecution","models":[{"name":"notification_workflow_step_execution_logs","description":"This table captures detailed execution logs for each workflow step run by worker servers. It records each attempt's input, output, timestamps, and result, associating logs with workflow, trigger instances, and nodes. It supports robust audit trails and troubleshooting by providing immutable records of every step execution in the Notification Workflow system.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"workflow_id","type":"uuid","description":"Referenced workflow's notification_workflow_workflows.id.","relation":{"name":"workflow","targetModel":"notification_workflow_workflows"},"unique":false,"nullable":false},{"name":"trigger_id","type":"uuid","description":"Referenced trigger instance's notification_workflow_trigger_instances.id.","relation":{"name":"trigger","targetModel":"notification_workflow_trigger_instances"},"unique":false,"nullable":false},{"name":"node_id","type":"uuid","description":"Referenced workflow node's notification_workflow_workflow_nodes.id.","relation":{"name":"node","targetModel":"notification_workflow_workflow_nodes"},"unique":false,"nullable":false}],"plainFields":[{"name":"attempt","type":"int","description":"Attempt number of this execution step, starting from 1.","nullable":false},{"name":"started_at","type":"datetime","description":"Timestamp when execution of this step started.","nullable":false},{"name":"finished_at","type":"datetime","description":"Timestamp when execution of this step finished.","nullable":false},{"name":"input_context","type":"string","description":"JSON string capturing the input execution context for this step.","nullable":false},{"name":"output_context","type":"string","description":"JSON string capturing the output execution context after this step.","nullable":false},{"name":"success","type":"boolean","description":"Whether this execution step succeeded.","nullable":false},{"name":"email_message_id","type":"string","description":"Identifier of the email message if this step sent an email; null otherwise.","nullable":true},{"name":"sms_message_id","type":"string","description":"Identifier of the SMS message if this step sent an SMS; null otherwise.","nullable":true},{"name":"error_message","type":"string","description":"Error message if the execution step failed; null otherwise.","nullable":true}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["workflow_id","started_at"]},{"fieldNames":["trigger_id","started_at"]},{"fieldNames":["node_id","started_at"]}],"ginIndexes":[]}]},{"filename":"schema-05-core.prisma","namespace":"Core","models":[{"name":"notification_workflow_node_templates","description":"This table stores reusable node templates for notification workflows including email, sms, and delay templates. Each template is identified by a unique code and classified by type to facilitate consistent workflow node creation and management. Templates contain LiquidJS template bodies defining the content or behavior of each node type. This core entity enables flexible and centralized management of notification content templates used by workflow nodes across the system.","material":false,"stance":"primary","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[],"plainFields":[{"name":"code","type":"string","nullable":false,"description":"Unique business identifier code for the node template."},{"name":"name","type":"string","nullable":false,"description":"Human-readable name of the node template."},{"name":"type","type":"string","nullable":false,"description":"Type of the node template: \"email\", \"sms\", or \"delay\"."},{"name":"template_body","type":"string","nullable":false,"description":"LiquidJS template content of the node template."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp when the template was created."},{"name":"updated_at","type":"datetime","nullable":false,"description":"Timestamp when the template was last updated."}],"uniqueIndexes":[{"fieldNames":["code"],"unique":true}],"plainIndexes":[{"fieldNames":["type"]}],"ginIndexes":[{"fieldName":"template_body"}]}]},{"filename":"schema-06-auditlogs.prisma","namespace":"AuditLogs","models":[{"name":"notification_workflow_audit_logs","description":"Audit log records capturing immutable events related to workflows, triggers, user roles, and system operations for compliance and forensic analysis.","material":false,"stance":"snapshot","primaryField":{"name":"id","type":"uuid","description":"Primary Key."},"foreignFields":[{"name":"actor_id","type":"uuid","description":"ID of the user or system actor responsible for the event, nullable for system events. {@link notification_workflow_workflowmanagers.id}","relation":{"name":"actor","targetModel":"notification_workflow_workflowmanagers"},"unique":false,"nullable":true}],"plainFields":[{"name":"event_type","type":"string","nullable":false,"description":"Type of event recorded (e.g., workflow_created, trigger_fired, user_role_assigned)."},{"name":"event_data","type":"string","nullable":false,"description":"JSON string containing detailed event data and context."},{"name":"created_at","type":"datetime","nullable":false,"description":"Timestamp of when the event was recorded."}],"uniqueIndexes":[],"plainIndexes":[{"fieldNames":["actor_id"]},{"fieldNames":["created_at"]}],"ginIndexes":[]}]}]}