# Compliance 및 개인정보 보호 요구사항 정의

## 1. 개요 및 목적
본 문서는 StoryField AI Server가 반드시 준수해야 할 개인정보 보호, 인증정보(토큰) 관리, 생성 컨텐츠 저작권, 콘텐츠 모더레이션, 데이터 저장/삭제 정책 등 다양한 법률적·비즈니스 컴플라이언스 요구조건을 정의한다. 백엔드 개발, 보안, 법무팀이 서비스를 구현·운영할 때 필요한 구체적 비즈니스 규칙과 기대수준을 제시한다.

## 2. 사용자 데이터 프라이버시 및 접근통제
- WHEN 사용자가 회원가입 및 인증을 통해 서비스를 사용하는 경우, THE 시스템 SHALL 사용자 식별 정보(이메일, 고유 식별자) 및 최소한의 프로필 데이터만 백엔드(Spring)에서 저장 및 관리한다.
- WHERE 개인정보 및 민감 정보(생성한 동화, 오디오, 이미지는 사용자 고유 identifier로 연결될 수 있음)가 존재, THE 시스템 SHALL 해당 정보에 대한 접근을 오직 본인 및 시스템 관리자의 엄격한 인증/권한 검증 하에만 허용한다.
- IF 권한이 없는 사용자가 타인의 컨텐츠나 개인정보 접근 요청 시, THEN THE 시스템 SHALL 접근을 거부하고 401 혹은 403 에러코드를 반환한다.
- IF 사용자가 계정 탈퇴 혹은 데이터 삭제를 요구하는 경우, THEN THE 시스템 SHALL 관련 데이터(동화, 오디오, TTS 오디오 등)를 완전히 삭제 처리하고, 복구 불가 상태로 처리한다.
- THE 시스템 SHALL 개인정보 접근내역과 이용로그를 보존하고 관리한다(법적 필요시 열람 가능하도록).

## 3. 토큰, 인증정보 및 권한 관리
- WHEN 사용자가 로그인을 통해 토큰(Access Token, Refresh Token) 발급 받은 경우, THE 시스템 SHALL 해당 토큰의 유효성과 만료, 무단 재사용 방지를 위한 유효성 검증 절차를 수행한다.
- THE 시스템 SHALL 모든 외부 요청(동화 생성, TTS 등 주요 API)에 대해 access token 필수 검증후 처리한다.
- THE 시스템 SHALL 토큰 정보, credential 및 기타 중요한 정보를 .env.* 파일 등 비노출 환경설정에 저장한다.
- IF 토큰이 만료되었거나 조작 의심 발생시, THEN THE 시스템 SHALL 즉시 요청을 차단하고 401/403 응답을 반환한다.
- THE 시스템 SHALL Spring 백엔드와 토큰 교환시 HTTPS 및 Bearer Token 방식 활용을 강제하고, 토큰 중간 노출, 로깅 금지(비즈니스적 요구)

| Token 관리 요구사항 | 상세 규칙 |
|---------------------|----------|
| 만료/갱신 정책 | Access: 15분~30분, Refresh: 7일~30일. 만료시 재인증 필요 |
| Token 저장 | HttpOnly 쿠키 또는 서버 캐시(보안 필요성에 따라) |
| Payload | 최소 userId, role, 발급 시간 포함, 비밀번호 plaintext 포함 금지 |
| Token 폐기 | 로그아웃 또는 탈퇴 등에서 즉시 무효화, Redis 등에서 블랙리스트 관리 |

## 4. 생성 컨텐츠의 저작권
- WHEN 사용자가 시스템을 통해 동화/이미지/오디오를 생성하는 경우, THE 시스템 SHALL 생성물의 1차 저작권 및 이용허락 관련 정보를 사용자 및(서비스 운영사) 쌍방이 명확히 인지할 수 있도록 고지한다.
- THE 시스템 SHALL 생성된 컨텐츠(텍스트, 이미지, 오디오 등)의 저작권 귀속 방침, 서비스 이용약관 내 명확히 안내하고, 사용자 요청시 이용 내역을 열람 또는 삭제할 수 있도록 한다.
- WHERE 외부 AI API를 통해 생성된 컨텐츠가 제3자 저작권 침해 우려가 있는 경우, THE 시스템 SHALL 즉시 해당 생성물의 배포를 중단하고, 사용자 및 관리팀에 알린다.
- IF 저작권 관련 분쟁 발생시, THEN THE 시스템 SHALL 관련 생성내역, 사용이력(로그), 원본 데이터를 최대한 확보하여 법적 대응이 가능하도록 관리한다.
- THE 시스템 SHALL 사용자별로 생성 컨텐츠의 원본 소유권 및 서비스 내 재이용/배포 권한의 범위를 구체적으로 설명한다(예: 서비스 내 이용은 허용, 외부 배포/상업적 이용은 제한 등).

## 5. 콘텐츠 모더레이션 및 악용 방지
- WHEN 사용자가 컨텐츠(동화 텍스트, 오디오 등) 생성 또는 업로드 요청을 하는 경우, THE 시스템 SHALL 외설적, 혐오, 차별, 범죄 유도 등 부적절 컨텐츠 자동 감지/차단 규칙을 적용한다.
- IF 자동 모더레이션 감지 또는 사용자의 신고 요청이 접수되는 경우, THEN THE 시스템 SHALL 해당 컨텐츠를 즉시 블라인드 처리 후 관리팀에 알린다.
- WHERE 반복적 악용, 대량 생성, 비정상 패턴 탐지시, THE 시스템 SHALL 해당 계정 및 요청을 IP 혹은 토큰 기준으로 차단 및 모니터링 한다.
- THE 시스템 SHALL 생성/업로드된 모든 컨텐츠에 대해 신고 후 24시간 이내 1차 분류/조치 결과를 사용자 및 신고자에게 통지한다.
- IF 모더레이션 결과 컨텐츠가 정상으로 판정된 경우, THEN THE 시스템 SHALL 원 컨텐츠의 게시를 재개하고, 관련 사유를 사용자에 안내한다.

## 6. 데이터 보관 및 삭제 정책
- THE 시스템 SHALL 사용자 계정, 생성 컨텐츠, 로그 데이터를 개인정보 관련 법령 또는 내부 정책에서 정한 최대 보관기간내에서만 유지/보관한다.
- WHEN 보관기간 경과, 사용자 탈퇴 혹은 삭제 요청 발생시, THE 시스템 SHALL 즉시 연관 데이터(콘텐츠, 오디오 등)를 복원 불가한 방식으로 삭제/파기한다.
- WHERE 법적 보존 의무(수사, 분쟁 등) 발생할 경우, THE 시스템 SHALL 해당 데이터/로그를 법적 근거 대로 별도 보관한다.
- THE 시스템 SHALL 사용자마다 데이터 보관 기간, 삭제 방법, 삭제 처리 결과 고지(이메일 알림 등)를 지원한다.

| 데이터 종류         | 최대 보관 기간 | 비고                                 |
|--------------------|---------------|--------------------------------------|
| 계정 정보           | 1년(탈퇴시 즉시 삭제) | 탈퇴 즉시 삭제, 잔여 로그 별도 보관 가능 |
| 생성 텍스트/이미지/오디오 | 6개월~1년      | 서비스/기술정책에 따라 차등 가능      |
| 이용 로그/접근 기록 | 1년           | 법적 필요시 연장 가능(내부 방침)       |

## 7. 컴플라이언스 및 개인정보 보호 관련 요구사항 (EARS 포맷)
- WHEN 사용자가 회원가입, 로그인, 동화 생성, TTS 요청 등 개인정보 기반 기능을 이용하는 경우, THE 시스템 SHALL 최소한의 개인정보 및 사용 로그만 수집/보관한다.
- WHERE 사용자 데이터 또는 인증정보가 외부 시스템(예: Spring, S3 등)과 교환되는 경우, THE 시스템 SHALL 항상 암호화된 연결(HTTPS) 및 필요최소 정보만 송수신한다.
- IF 사용자가 본인 데이터 열람, 삭제를 요청하는 경우, THEN THE 시스템 SHALL 7일 이내 해당 요청을 처리하고 결과를 사용자에게 통지한다.
- WHEN 외부 AI/클라우드 벤더와 연동하여 생성 컨텐츠를 반환하는 경우, THE 시스템 SHALL API Key, Secret 등 민감 정보가 노출되지 않도록 환경변수 관리 및 로그 차단을 강제한다.
- WHEN 서비스가 폐지되거나 운영정책/법령이 변경되는 경우, THE 시스템 SHALL 모든 개인정보 및 생성 데이터에 대한 최신 파기/보관정책을 공지 및 적용한다.

## 8. 예외 및 향후 확장 고려 사항
- 향후 법령, AI 윤리 기준, 사용자 및 파트너 요구에 따라 데이터 보관기간, 저작권 정책, 접근제어 관련 사항은 재검토/확장될 수 있다.
- THE 시스템 SHALL 정책 변경, 추가가능성 및 예외 발생시 명확한 심사 프로세스(법무-보안-개발 승인 등)를 경유하도록 한다.

---
본 문서는 [User Role and Permission Requirements Document](./04-user-roles-and-permissions.md), [Business Requirements Definition Document](./02-business-requirements.md), [Integration Requirements and Operational Security Document](./06-integration-requirements.md)와 연계하여 해석 및 적용되어야 한다.