import { tags } from "typia";

/**
 * A single revoked token/session record, used for security incident, audit, and
 * compliance reporting.
 *
 * Describes key details of who/what was revoked, why, when, and by whom (if not
 * automated). May reference a token session, authenticated user, or admin based
 * on the event context. Required for all privileged revocation event records.
 *
 * @autobe Generated by AutoBE - https://github.com/wrtnlabs/autobe
 */
export type IStoryfieldAiTokenRevocation = {
  /**
   * Primary key universally unique identifier for the token revocation
   * record. Used as a reference in audit logs and relations.
   */
  id: string & tags.Format<"uuid">;

  /** The associated token session's UUID, if known at the time of revocation. */
  token_session_id?: (string & tags.Format<"uuid">) | null | undefined;

  /** UUID of the authenticated user who owned the revoked token/session. */
  authenticated_user_id?: (string & tags.Format<"uuid">) | null | undefined;

  /**
   * UUID of the system admin responsible for this revocation, or null for
   * automated events.
   */
  system_admin_id?: (string & tags.Format<"uuid">) | null | undefined;

  /**
   * The hashed value of the revoked token. Never revealed as a plaintext
   * token. Used for future deny-list checks.
   */
  token_hash: string;

  /**
   * Reason the token/session was revoked: compromise, logout, rotation,
   * abuse, etc. Required for audit and compliance.
   */
  revoked_reason: string;

  /** Source IP address from which revocation was initiated, if available. */
  revoked_by_ip?: string | null | undefined;

  /**
   * Timestamp the revocation event was created. Required for audit and legal
   * compliance.
   */
  created_at: string & tags.Format<"date-time">;
};
export namespace IStoryfieldAiTokenRevocation {
  /**
   * Search and filter specifications for token revocation records. Allows
   * system admins to query for events by token hash, reason, actor, or
   * creation period for incident review, audit, and compliance monitoring.
   */
  export type IRequest = {
    /**
     * Search for token revocation records with this hashed token value.
     * Always hashed, never plaintext.
     */
    token_hash?: string | undefined;

    /**
     * Filter by the recorded reason for token revocation (e.g., compromise,
     * logout, abuse). Partial matches supported.
     */
    revoked_reason?: string | undefined;

    /**
     * Optionally filter to only token revocations for this authenticated
     * user.
     */
    authenticated_user_id?: (string & tags.Format<"uuid">) | undefined;

    /** Optionally filter to only revocations performed by this system admin. */
    system_admin_id?: (string & tags.Format<"uuid">) | undefined;

    /** Filter for records created on or after this UTC date/time. */
    created_from?: (string & tags.Format<"date-time">) | undefined;

    /** Filter for records created before or up to this UTC date/time. */
    created_to?: (string & tags.Format<"date-time">) | undefined;

    /** Page number for pagination. Starts at 1. */
    page?: number | undefined;

    /**
     * Number of records per page. Maximum reasonable value enforced by
     * implementation.
     */
    limit?: number | undefined;
  };

  /**
   * Summary/row view for token revocation event
   * (storyfield_ai_token_revocations). Designed for admin logs and
   * abuse/audit monitoring.
   */
  export type ISummary = {
    /**
     * Unique identifier for the revocation event (PK, UUID from
     * storyfield_ai_token_revocations).
     */
    id: string & tags.Format<"uuid">;

    /**
     * Optional reference to the authenticated user whose token was revoked.
     * Nullable if revocation did not target a specific user.
     */
    authenticated_user_id: (string & tags.Format<"uuid">) | null;

    /**
     * Optional reference to the system administrator who performed the
     * revocation.
     */
    system_admin_id: (string & tags.Format<"uuid">) | null;

    /**
     * SHA or bcrypt hash of the revoked token value. Not the real token;
     * shown for referential audit.
     */
    token_hash: string;

    /** Human- or system-generated reason for the token revocation event. */
    revoked_reason: string;

    /**
     * IP address from which the revocation operation originated (nullable
     * if not recorded).
     */
    revoked_by_ip: string | null;

    /** Timestamp (ISO 8601) when the revocation was recorded. */
    created_at: string & tags.Format<"date-time">;
  };
}
