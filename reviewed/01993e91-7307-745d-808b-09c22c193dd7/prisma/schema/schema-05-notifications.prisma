/// This table stores notifications generated by the system related to task
/// events, assignments, status changes, and general alerts for users. Each
/// notification tracks the target user, related task if any, notification
/// type, read status, and timestamps. It serves as the primary entity for
/// user alerts within the task management system.
///
/// @namespace Notifications
/// @author AutoBE - https://github.com/wrtnlabs/autobe
model task_management_notifications {
  //----
  // COLUMNS
  //----
  /// Primary Key.
  id String @id
  
  /// Target user's {@link task_management_tpm.id}, {@link
  /// task_management_pm.id}, {@link task_management_pmo.id}, {@link
  /// task_management_developer.id}, {@link task_management_designer.id}, or
  /// {@link task_management_qa.id}.
  user_id String
  
  /// Related task's {@link task_management_tasks.id}, nullable for general or
  /// system notifications.
  task_id String?
  
  /// Type of notification such as 'assignment', 'status_change', 'comment',
  /// 'general'.
  notification_type String
  
  /// Flag indicating whether the notification has been read by the user.
  is_read Boolean
  
  /// Timestamp when the notification was read. Null if unread.
  read_at DateTime?
  
  /// Timestamp when the notification was created.
  created_at DateTime
  
  /// Timestamp when the notification record was last updated.
  updated_at DateTime
  
  /// Timestamp when the notification was deleted (soft delete). Nullable if
  /// not deleted.
  deleted_at DateTime?
  
  //----
  // RELATIONS
  //----
  user task_management_tpm @relation(fields: [user_id], references: [id], onDelete: Cascade)
  task task_management_tasks? @relation(fields: [task_id], references: [id], onDelete: Cascade)
  
  @@index([task_id])
  
  @@unique([user_id, task_id, notification_type, created_at], map: "task_management_notifications_user_id_task_id_notifica_cc647dc8")
  @@index([user_id, created_at])
}

/// This table stores individual user preferences for receiving different
/// types of notifications within the task management system. Preferences
/// specify which notification categories a user opts into and notification
/// delivery options such as email or push notifications.
///
/// @namespace Notifications
/// @author AutoBE - https://github.com/wrtnlabs/autobe
model task_management_notification_preferences {
  //----
  // COLUMNS
  //----
  /// Primary Key.
  id String @id
  
  /// User owning these notification preferences, referencing their role table
  /// such as {@link task_management_tpm.id}, {@link task_management_pm.id},
  /// {@link task_management_pmo.id}, {@link task_management_developer.id},
  /// {@link task_management_designer.id}, or {@link task_management_qa.id}.
  user_id String
  
  /// Notification preference key, e.g. 'assignment', 'status_change',
  /// 'comment', indicating the type of notification this preference controls.
  preference_key String
  
  /// Indicates if the notification preference is enabled or disabled.
  enabled Boolean
  
  /// Preferred method for notification delivery, such as 'email', 'push', or
  /// 'sms'.
  delivery_method String
  
  /// Timestamp when the preference was created.
  created_at DateTime
  
  /// Timestamp when the preference was last updated.
  updated_at DateTime
  
  /// Timestamp when the preference was deleted (soft delete). Nullable if not
  /// deleted.
  deleted_at DateTime?
  
  //----
  // RELATIONS
  //----
  user task_management_tpm @relation(fields: [user_id], references: [id], onDelete: Cascade)
  
  @@unique([user_id])
  
  @@unique([user_id, preference_key], map: "task_management_notification_preferences_user_id_prefe_3dcfa53c")
  @@index([user_id, enabled])
}