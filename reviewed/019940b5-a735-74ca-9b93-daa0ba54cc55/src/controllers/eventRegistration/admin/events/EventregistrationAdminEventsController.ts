import { Controller } from "@nestjs/common";
import { TypedRoute, TypedBody, TypedParam } from "@nestia/core";
import typia, { tags } from "typia";
import { posteventRegistrationAdminEvents } from "../../../../providers/posteventRegistrationAdminEvents";
import { AdminAuth } from "../../../../decorators/AdminAuth";
import { AdminPayload } from "../../../../decorators/payload/AdminPayload";
import { puteventRegistrationAdminEventsEventId } from "../../../../providers/puteventRegistrationAdminEventsEventId";
import { deleteeventRegistrationAdminEventsEventId } from "../../../../providers/deleteeventRegistrationAdminEventsEventId";

import { IEventRegistrationEvent } from "../../../../api/structures/IEventRegistrationEvent";

@Controller("/eventRegistration/admin/events")
export class EventregistrationAdminEventsController {
  /**
   * Create a new event with provided details including category, scheduled
   * date, location, capacity, optional description, ticket price, and event
   * status.
   *
   * Only users with eventOrganizer or admin roles may create events.
   *
   * The request body must include valid values respecting validation
   * constraints from the Prisma schema such as positive capacity and valid
   * category reference.
   *
   * On success, returns the created event entity including generated UUID and
   * timestamps.
   *
   * Clients use this to add new events to the system which can then be browsed
   * and signed up for by regular users.
   *
   * The method used is POST since this operation creates a new resource.
   *
   * @param connection
   * @param body New event creation data
   * @nestia Generated by Nestia - https://github.com/samchon/nestia
   */
  @TypedRoute.Post()
  public async create(
    @AdminAuth()
    admin: AdminPayload,
    @TypedBody()
    body: IEventRegistrationEvent.ICreate,
  ): Promise<IEventRegistrationEvent> {
    try {
      return await posteventRegistrationAdminEvents({
        admin,
        body,
      });
    } catch (error) {
      console.log(error);
      throw error;
    }
  }

  /**
   * Update an existing event by eventId.
   *
   * Update an existing event identified by eventId with new property values
   * including category, name, date, location, capacity, optional description,
   * ticket price, and status.
   *
   * Only eventOrganizers owning the event or admins may update events.
   *
   * Request body must comply with Prisma schema validation constraints.
   *
   * Returns the updated event entity on success.
   *
   * Intended for clients modifying event details such as rescheduling or
   * capacity adjustments.
   *
   * Method used is PUT as this constitutes full replacement of the resource's
   * modifiable attributes.
   *
   * @param connection
   * @param eventId Unique identifier of the event to update
   * @param body Updated event data
   * @nestia Generated by Nestia - https://github.com/samchon/nestia
   */
  @TypedRoute.Put(":eventId")
  public async update(
    @AdminAuth()
    admin: AdminPayload,
    @TypedParam("eventId")
    eventId: string & tags.Format<"uuid">,
    @TypedBody()
    body: IEventRegistrationEvent.IUpdate,
  ): Promise<IEventRegistrationEvent> {
    try {
      return await puteventRegistrationAdminEventsEventId({
        admin,
        eventId,
        body,
      });
    } catch (error) {
      console.log(error);
      throw error;
    }
  }

  /**
   * Delete an event by eventId.
   *
   * Delete an event by its unique eventId. This operation permanently removes
   * the event and cannot be undone.
   *
   * Only users with the admin role may delete events.
   *
   * No request body is needed. The eventId path parameter identifies the target
   * event.
   *
   * Response contains no data.
   *
   * This hard delete operation is final and will remove all event data from the
   * system.
   *
   * The HTTP method is DELETE representing the destructive action.
   *
   * @param connection
   * @param eventId Unique identifier of the event to delete
   * @nestia Generated by Nestia - https://github.com/samchon/nestia
   */
  @TypedRoute.Delete(":eventId")
  public async erase(
    @AdminAuth()
    admin: AdminPayload,
    @TypedParam("eventId")
    eventId: string & tags.Format<"uuid">,
  ): Promise<void> {
    try {
      return await deleteeventRegistrationAdminEventsEventId({
        admin,
        eventId,
      });
    } catch (error) {
      console.log(error);
      throw error;
    }
  }
}
