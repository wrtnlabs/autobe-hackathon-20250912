import { Controller } from "@nestjs/common";
import { TypedRoute, TypedBody } from "@nestia/core";
import typia from "typia";
import { patchhealthcarePlatformOrganizationAdminComplianceAgreements } from "../../../../providers/patchhealthcarePlatformOrganizationAdminComplianceAgreements";
import { OrganizationadminAuth } from "../../../../decorators/OrganizationadminAuth";
import { OrganizationadminPayload } from "../../../../decorators/payload/OrganizationadminPayload";

import { IPageIHealthcarePlatformComplianceAgreement } from "../../../../api/structures/IPageIHealthcarePlatformComplianceAgreement";
import { IHealthcarePlatformComplianceAgreement } from "../../../../api/structures/IHealthcarePlatformComplianceAgreement";

@Controller("/healthcarePlatform/organizationAdmin/complianceAgreements")
export class HealthcareplatformOrganizationadminComplianceagreementsController {
  /**
   * Search and paginate compliance agreements by filter, returning audit-ready
   * summaries.
   *
   * The search operation allows auditors, compliance staff, or administrators
   * to review compliance agreements (official documents signed by patients or
   * staff) according to various business and audit criteria. Supported filters
   * include organization, policy version, signer, agreement type, status, date
   * signed, and expiration range. Pagination and sorting are standard for large
   * compliance datasets (e.g., paged by date signed or status).
   *
   * Only users with appropriate regulatory/audit roles are permitted access,
   * with all queries logged for compliance reporting. The endpoint is not used
   * for consent search (separate entity with different audit requirements).
   * Search criteria must comply with privacy and regulatory scope:
   * non-compliance users cannot see organization-wide or cross-tenant
   * agreements.
   *
   * Error handling includes invalid filters, empty results, or permission
   * failures. Successful queries return a page of
   * IHealthcarePlatformComplianceAgreement.ISummary data, with pagination
   * metadata and total count.
   *
   * This operation fully respects all data privacy, role-based control, and
   * compliance auditing rules at the platform and org level.
   *
   * @param connection
   * @param body Search and filter criteria for compliance agreement search with
   *   pagination and sorting.
   * @nestia Generated by Nestia - https://github.com/samchon/nestia
   */
  @TypedRoute.Patch()
  public async index(
    @OrganizationadminAuth()
    organizationAdmin: OrganizationadminPayload,
    @TypedBody()
    body: IHealthcarePlatformComplianceAgreement.IRequest,
  ): Promise<IPageIHealthcarePlatformComplianceAgreement.ISummary> {
    try {
      return await patchhealthcarePlatformOrganizationAdminComplianceAgreements(
        {
          organizationAdmin,
          body,
        },
      );
    } catch (error) {
      console.log(error);
      throw error;
    }
  }
}
